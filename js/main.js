/*
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
(function(){function a(f){f=String(f);return f.charAt(0).toUpperCase()+f.slice(1)}function b(f,t){var G=-1,A=f?f.length:0;if("number"==typeof A&&-1<A&&A<=v)for(;++G<A;)t(f[G],G,f);else e(f,t)}function c(f){f=String(f).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(f)?f:a(f)}function e(f,t){for(var G in f)x.call(f,G)&&t(f[G],G,f)}function k(f){return null==f?a(f):r.call(f).slice(8,-1)}function p(f,t){var G=null!=f?typeof f[t]:"number";return!/^(?:boolean|number|string|undefined)$/.test(G)&&
("object"==G?!!f[t]:!0)}function n(f){return String(f).replace(/([ -])(?!$)/g,"$1?")}function m(f,t){var G=null;b(f,function(A,z){G=t(G,A,z,f)});return G}function d(f){function t(O){return m(O,function(K,J){var R=J.pattern||n(J);!K&&(K=RegExp("\\b"+R+" *\\d+[.\\w_]*","i").exec(f)||RegExp("\\b"+R+" *\\w+-[\\w]*","i").exec(f)||RegExp("\\b"+R+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(f))&&((K=String(J.label&&!RegExp(R,"i").test(J.label)?J.label:K).split("/"))[1]&&!/[\d.]+/.test(K[0])&&(K[0]+=
" "+K[1]),J=J.label||J,K=c(K[0].replace(RegExp(R,"i"),J).replace(RegExp("; *(?:"+J+"[_-])?","i")," ").replace(RegExp("("+J+")[-_.]?(\\w)","i"),"$1 $2")));return K})}function G(O){return m(O,function(K,J){return K||(RegExp(J+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(f)||0)[1]||null})}var A=w,z=f&&"object"==typeof f&&"String"!=k(f);z&&(A=f,f=null);var E=A.navigator||{},B=E.userAgent||"";f||(f=B);var P=z?!!E.likeChrome:/\bChrome\b/.test(f)&&!/internal|\n/i.test(r.toString()),
L=z?"Object":"ScriptBridgingProxyObject",M=z?"Object":"Environment",Q=z&&A.java?"JavaPackage":k(A.java),S=z?"Object":"RuntimeObject";M=(Q=/\bJava/.test(Q)&&A.java)&&k(A.environment)==M;var aa=Q?"a":"\u03b1",X=Q?"b":"\u03b2",V=A.document||{},W=A.operamini||A.opera,U=q.test(U=z&&W?W["[[Class]]"]:k(W))?U:W=null,l,Y=f;z=[];var F=null,N=f==B;B=N&&W&&"function"==typeof W.version&&W.version();var H=function(O){return m(O,function(K,J){return K||RegExp("\\b"+(J.pattern||n(J))+"\\b","i").exec(f)&&(J.label||
J)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),C=function(O){return m(O,function(K,J){return K||RegExp("\\b"+(J.pattern||n(J))+"\\b","i").exec(f)&&(J.label||J)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser",
"PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},
{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),I=t([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad",
"iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),T=function(O){return m(O,function(K,J,R){return K||(J[I]||J[/^[a-z]+(?: +[a-z]+\b)*/i.exec(I)]||RegExp("\\b"+n(R)+"(?:\\b|\\w*\\d)","i").exec(f))&&R})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},
"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),D=function(O){return m(O,function(K,J){var R=J.pattern||n(J);if(!K&&(K=RegExp("\\b"+R+"(?:/[\\d.]+|[ \\w.]*)","i").exec(f))){var Z=K,ba=J.label||J,ca={"10.0":"10","6.4":"10 Technical Preview",
"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};R&&ba&&/^Win/i.test(Z)&&!/^Windows Phone /i.test(Z)&&(ca=ca[/[\d.]+$/.exec(Z)])&&(Z="Windows "+ca);Z=String(Z);R&&ba&&(Z=Z.replace(RegExp(R,"i"),ba));K=Z=c(Z.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,
"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return K})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X",
"Macintosh","Mac","Windows 98;","Windows "]);H&&(H=[H]);T&&!I&&(I=t([T]));if(l=/\bGoogle TV\b/.exec(I))I=l[0];/\bSimulator\b/i.test(f)&&(I=(I?I+" ":"")+"Simulator");"Opera Mini"==C&&/\bOPiOS\b/.test(f)&&z.push("running in Turbo/Uncompressed mode");"IE"==C&&/\blike iPhone OS\b/.test(f)?(l=d(f.replace(/like iPhone OS/,"")),T=l.manufacturer,I=l.product):/^iP/.test(I)?(C||(C="Safari"),D="iOS"+((l=/ OS ([\d_]+)/i.exec(f))?" "+l[1].replace(/_/g,"."):"")):"Konqueror"!=C||/buntu/i.test(D)?T&&"Google"!=T&&
(/Chrome/.test(C)&&!/\bMobile Safari\b/i.test(f)||/\bVita\b/.test(I))||/\bAndroid\b/.test(D)&&/^Chrome/.test(C)&&/\bVersion\//i.test(f)?(C="Android Browser",D=/\bAndroid\b/.test(D)?D:"Android"):"Silk"==C?(/\bMobi/i.test(f)||(D="Android",z.unshift("desktop mode")),/Accelerated *= *true/i.test(f)&&z.unshift("accelerated")):"PaleMoon"==C&&(l=/\bFirefox\/([\d.]+)\b/.exec(f))?z.push("identifying as Firefox "+l[1]):"Firefox"==C&&(l=/\b(Mobile|Tablet|TV)\b/i.exec(f))?(D||(D="Firefox OS"),I||(I=l[1])):!C||
(l=!/\bMinefield\b/i.test(f)&&/\b(?:Firefox|Safari)\b/.exec(C))?(C&&!I&&/[\/,]|^[^(]+?\)/.test(f.slice(f.indexOf(l+"/")+8))&&(C=null),(l=I||T||D)&&(I||T||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(D))&&(C=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(D)?D:l)+" Browser")):"Electron"==C&&(l=(/\bChrome\/([\d.]+)\b/.exec(f)||0)[1])&&z.push("Chromium "+l):D="Kubuntu";B||(B=G(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",n(C),
"(?:Firefox|Minefield|NetFront)"]));if(l="iCab"==H&&3<parseFloat(B)&&"WebKit"||/\bOpera\b/.test(C)&&(/\bOPR\b/.test(f)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(f)&&!/^(?:Trident|EdgeHTML)$/.test(H)&&"WebKit"||!H&&/\bMSIE\b/i.test(f)&&("Mac OS"==D?"Tasman":"Trident")||"WebKit"==H&&/\bPlayStation\b(?! Vita\b)/i.test(C)&&"NetFront")H=[l];"IE"==C&&(l=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(f)||0)[1])?(C+=" Mobile",D="Windows Phone "+(/\+$/.test(l)?l:l+".x"),z.unshift("desktop mode")):/\bWPDesktop\b/i.test(f)?
(C="IE Mobile",D="Windows Phone 8.x",z.unshift("desktop mode"),B||(B=(/\brv:([\d.]+)/.exec(f)||0)[1])):"IE"!=C&&"Trident"==H&&(l=/\brv:([\d.]+)/.exec(f))&&(C&&z.push("identifying as "+C+(B?" "+B:"")),C="IE",B=l[1]);if(N){if(p(A,"global"))if(Q&&(l=Q.lang.System,Y=l.getProperty("os.arch"),D=D||l.getProperty("os.name")+" "+l.getProperty("os.version")),M){try{B=A.require("ringo/engine").version.join("."),C="RingoJS"}catch(O){(l=A.system)&&l.global.system==A.system&&(C="Narwhal",D||(D=l[0].os||null))}C||
(C="Rhino")}else"object"==typeof A.process&&!A.process.browser&&(l=A.process)&&("object"==typeof l.versions&&("string"==typeof l.versions.electron?(z.push("Node "+l.versions.node),C="Electron",B=l.versions.electron):"string"==typeof l.versions.nw&&(z.push("Chromium "+B,"Node "+l.versions.node),C="NW.js",B=l.versions.nw)),C||(C="Node.js",Y=l.arch,D=l.platform,B=(B=/[\d.]+/.exec(l.version))?B[0]:null));else k(l=A.runtime)==L?(C="Adobe AIR",D=l.flash.system.Capabilities.os):k(l=A.phantom)==S?(C="PhantomJS",
B=(l=l.version||null)&&l.major+"."+l.minor+"."+l.patch):"number"==typeof V.documentMode&&(l=/\bTrident\/(\d+)/i.exec(f))?(B=[B,V.documentMode],(l=+l[1]+4)!=B[1]&&(z.push("IE "+B[1]+" mode"),H&&(H[1]=""),B[1]=l),B="IE"==C?String(B[1].toFixed(1)):B[0]):"number"==typeof V.documentMode&&/^(?:Chrome|Firefox)\b/.test(C)&&(z.push("masking as "+C+" "+B),C="IE",B="11.0",H=["Trident"],D="Windows");D=D&&c(D)}B&&(l=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(B)||/(?:alpha|beta)(?: ?\d)?/i.exec(f+";"+(N&&E.appMinorVersion))||
/\bMinefield\b/i.test(f)&&"a")&&(F=/b/i.test(l)?"beta":"alpha",B=B.replace(RegExp(l+"\\+?$"),"")+("beta"==F?X:aa)+(/\d+\+?/.exec(l)||""));if("Fennec"==C||"Firefox"==C&&/\b(?:Android|Firefox OS)\b/.test(D))C="Firefox Mobile";else if("Maxthon"==C&&B)B=B.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(I))"Xbox 360"==I&&(D=null),"Xbox 360"==I&&/\bIEMobile\b/.test(f)&&z.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(C)&&(!C||I||/Browser|Mobi/.test(C))||"Windows CE"!=D&&!/Mobi/i.test(f))if("IE"==
C&&N)try{null===A.external&&z.unshift("platform preview")}catch(O){z.unshift("embedded")}else(/\bBlackBerry\b/.test(I)||/\bBB10\b/.test(f))&&(l=(RegExp(I.replace(/ +/g," *")+"/([.\\d]+)","i").exec(f)||0)[1]||B)?(l=[l,/BB10/.test(f)],D=(l[1]?(I=null,T="BlackBerry"):"Device Software")+" "+l[0],B=null):this!=e&&"Wii"!=I&&(N&&W||/Opera/.test(C)&&/\b(?:MSIE|Firefox)\b/i.test(f)||"Firefox"==C&&/\bOS X (?:\d+\.){2,}/.test(D)||"IE"==C&&(D&&!/^Win/.test(D)&&5.5<B||/\bWindows XP\b/.test(D)&&8<B||8==B&&!/\bTrident\b/.test(f)))&&
!q.test(l=d.call(e,f.replace(q,"")+";"))&&l.name&&(l="ing as "+l.name+((l=l.version)?" "+l:""),q.test(C)?(/\bIE\b/.test(l)&&"Mac OS"==D&&(D=null),l="identify"+l):(l="mask"+l,C=U?c(U.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(l)&&(D=null),N||(B=null)),H=["Presto"],z.push(l));else C+=" Mobile";if(l=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(f)||0)[1]){l=[parseFloat(l.replace(/\.(\d)$/,".0$1")),l];if("Safari"==C&&"+"==l[1].slice(-1))C="WebKit Nightly",F="alpha",B=l[1].slice(0,-1);else if(B==
l[1]||B==(l[2]=(/\bSafari\/([\d.]+\+?)/i.exec(f)||0)[1]))B=null;l[1]=(/\bChrome\/([\d.]+)/i.exec(f)||0)[1];537.36==l[0]&&537.36==l[2]&&28<=parseFloat(l[1])&&"WebKit"==H&&(H=["Blink"]);N&&(P||l[1])?(H&&(H[1]="like Chrome"),l=l[1]||(l=l[0],530>l?1:532>l?2:532.05>l?3:533>l?4:534.03>l?5:534.07>l?6:534.1>l?7:534.13>l?8:534.16>l?9:534.24>l?10:534.3>l?11:535.01>l?12:535.02>l?"13+":535.07>l?15:535.11>l?16:535.19>l?17:536.05>l?18:536.1>l?19:537.01>l?20:537.11>l?"21+":537.13>l?23:537.18>l?24:537.24>l?25:537.36>
l?26:"Blink"!=H?"27":"28")):(H&&(H[1]="like Safari"),l=(l=l[0],400>l?1:500>l?2:526>l?3:533>l?4:534>l?"4+":535>l?5:537>l?6:538>l?7:601>l?8:"8"));H&&(H[1]+=" "+(l+="number"==typeof l?".x":/[.+]/.test(l)?"":"+"));"Safari"==C&&(!B||45<parseInt(B))&&(B=l)}"Opera"==C&&(l=/\bzbov|zvav$/.exec(D))?(C+=" ",z.unshift("desktop mode"),"zvav"==l?(C+="Mini",B=null):C+="Mobile",D=D.replace(RegExp(" *"+l+"$"),"")):"Safari"==C&&/\bChrome\b/.exec(H&&H[1])&&(z.unshift("desktop mode"),C="Chrome Mobile",B=null,/\bOS X\b/.test(D)?
(T="Apple",D="iOS 4.3+"):D=null);B&&0==B.indexOf(l=/[\d.]+$/.exec(D))&&-1<f.indexOf("/"+l+"-")&&(D=String(D.replace(l,"")).replace(/^ +| +$/g,""));H&&!/\b(?:Avant|Nook)\b/.test(C)&&(/Browser|Lunascape|Maxthon/.test(C)||"Safari"!=C&&/^iOS/.test(D)&&/\bSafari\b/.test(H[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(C)&&H[1])&&(l=H[H.length-1])&&z.push(l);z.length&&(z=["("+z.join("; ")+")"]);T&&I&&0>I.indexOf(T)&&z.push("on "+T);I&&z.push((/^on /.test(z[z.length-
1])?"":"on ")+I);if(D){var da=(l=/ ([\d.+]+)$/.exec(D))&&"/"==D.charAt(D.length-l[0].length-1);D={architecture:32,family:l&&!da?D.replace(l[0],""):D,version:l?l[1]:null,toString:function(){var O=this.version;return this.family+(O&&!da?" "+O:"")+(64==this.architecture?" 64-bit":"")}}}(l=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Y))&&!/\bi686\b/i.test(Y)?(D&&(D.architecture=64,D.family=D.family.replace(RegExp(" *"+l),"")),C&&(/\bWOW64\b/i.test(f)||N&&/\w(?:86|32)$/.test(E.cpuClass||E.platform)&&!/\bWin64; x64\b/i.test(f))&&
z.unshift("32-bit")):D&&/^OS X/.test(D.family)&&"Chrome"==C&&39<=parseFloat(B)&&(D.architecture=64);f||(f=null);A={};A.description=f;A.layout=H&&H[0];A.manufacturer=T;A.name=C;A.prerelease=F;A.product=I;A.ua=f;A.version=C&&B;A.os=D||{architecture:null,family:null,version:null,toString:function(){return"null"}};A.parse=d;A.toString=function(){return this.description||""};A.version&&z.unshift(B);A.name&&z.unshift(C);D&&C&&(D!=String(D).split(" ")[0]||D!=C.split(" ")[0]&&!I)&&z.push(I?"("+D+")":"on "+
D);z.length&&(A.description=z.join(" "));return A}var g={"function":!0,object:!0},w=g[typeof window]&&window||this,h=g[typeof exports]&&exports;g=g[typeof module]&&module&&!module.nodeType&&module;var u=h&&g&&"object"==typeof global&&global;!u||u.global!==u&&u.window!==u&&u.self!==u||(w=u);var v=Math.pow(2,53)-1,q=/\bOpera/;u=Object.prototype;var x=u.hasOwnProperty,r=u.toString,y=d();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(w.platform=y,define(function(){return y})):h&&
g?e(y,function(f,t){h[t]=f}):w.platform=y}).call(this);
function buildIOSMeta(){for(var a=[{name:"viewport",content:"width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black"}],b=0;b<a.length;b++){var c=document.createElement("meta");c.name=a[b].name;c.content=a[b].content;var e=window.document.head.querySelector('meta[name="'+c.name+'"]');e&&e.parentNode.removeChild(e);window.document.head.appendChild(c)}}
function hideIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","none");jQuery(".xxx-ios-fullscreen-scroll").css("display","none");jQuery(".xxx-game-iframe-full").removeClass("xxx-game-iframe-iphone-se")}function buildIOSFullscreenPanel(){jQuery("body").append('<div class="xxx-ios-fullscreen-message"><div class="xxx-ios-fullscreen-swipe"></div></div><div class="xxx-ios-fullscreen-scroll"></div>')}
function showIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","block");jQuery(".xxx-ios-fullscreen-scroll").css("display","block")}
function __iosResize(){window.scrollTo(0,0);console.log(window.devicePixelRatio);console.log(window.innerWidth);console.log(window.innerHeight);if("iPhone"===platform.product)switch(window.devicePixelRatio){case 2:switch(window.innerWidth){case 568:320!==window.innerHeight&&jQuery(".xxx-game-iframe-full").addClass("xxx-game-iframe-iphone-se");break;case 667:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();
break;default:hideIOSFullscreenPanel()}break;case 3:switch(window.innerWidth){case 736:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 724:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;default:hideIOSFullscreenPanel()}}function iosResize(){__iosResize();setTimeout(function(){__iosResize()},500)}
function iosInIframe(){try{return window.self!==window.top}catch(a){return!0}}function isIOSLessThen13(){var a=platform.os,b=a.family.toLowerCase();a=parseFloat(a.version);return"ios"===b&&13>a?!0:!1}$(document).ready(function(){platform&&"iPhone"===platform.product&&"safari"===platform.name.toLowerCase()&&isIOSLessThen13()&&!iosInIframe()&&(buildIOSFullscreenPanel(),buildIOSMeta())});
jQuery(window).resize(function(){platform&&"iPhone"===platform.product&&"safari"===platform.name.toLowerCase()&&isIOSLessThen13()&&!iosInIframe()&&iosResize()});var s_iScaleFactor=1,s_bIsIphone=!1,s_iOffsetX,s_iOffsetY,s_bFocus=!0;
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);$(window).resize(function(){sizeHandler()});function trace(a){console.log(a)}function isIOS(){for(var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");a.length;)if(navigator.platform===a.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}
function isIpad(){var a=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!a&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:a}function isMobile(){return isIpad()?!0:jQuery.browser.mobile}
function getSize(a){var b=a.toLowerCase(),c=window.document,e=c.documentElement;if(void 0===window["inner"+a])a=e["client"+a];else if(window["inner"+a]!=e["client"+a]){var k=c.createElement("body");k.id="vpw-test-b";k.style.cssText="overflow:scroll";var p=c.createElement("div");p.id="vpw-test-d";p.style.cssText="position:absolute;top:-1000px";p.innerHTML="<style>@media("+b+":"+e["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+b+":7px!important}}</style>";k.appendChild(p);e.insertBefore(k,c.head);
a=7==p["offset"+a]?e["client"+a]:window["inner"+a];e.removeChild(k)}else a=window["inner"+a];return a}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}
function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var a=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var b=getSize("Width");s_bFocus&&_checkOrientation(b,a);var c=Math.min(a/CANVAS_HEIGHT,b/CANVAS_WIDTH),e=Math.round(CANVAS_WIDTH*c);c=Math.round(CANVAS_HEIGHT*c);if(c<a){var k=a-c;c+=k;e+=CANVAS_WIDTH/CANVAS_HEIGHT*k}else e<b&&(k=b-e,e+=k,c+=CANVAS_HEIGHT/CANVAS_WIDTH*k);k=a/2-c/2;var p=b/2-e/2,n=CANVAS_WIDTH/e;if(p*n<-EDGEBOARD_X||
k*n<-EDGEBOARD_Y)c=Math.min(a/(CANVAS_HEIGHT-2*EDGEBOARD_Y),b/(CANVAS_WIDTH-2*EDGEBOARD_X)),e=Math.round(CANVAS_WIDTH*c),c=Math.round(CANVAS_HEIGHT*c),k=(a-c)/2,p=(b-e)/2,n=CANVAS_WIDTH/e;s_iOffsetX=-1*p*n;s_iOffsetY=-1*k*n;0<=k&&(s_iOffsetY=0);0<=p&&(s_iOffsetX=0);null!==s_oGame&&s_oGame.refreshButtonPos();null!==s_oMenu&&s_oMenu.refreshButtonPos();$("#canvas").css("width",e+"px");$("#canvas").css("height",c+"px");0>k||(k=(a-c)/2);$("#canvas").css("top",k+"px");$("#canvas").css("left",p+"px");fullscreenHandler()}}
function _checkOrientation(a,b){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>b?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function createBitmap(a,b,c){var e=new createjs.Bitmap(a),k=new createjs.Shape;b&&c?k.graphics.beginFill("#fff").drawRect(0,0,b,c):k.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);e.hitArea=k;return e}function createSprite(a,b,c,e,k,p){a=null!==b?new createjs.Sprite(a,b):new createjs.Sprite(a);b=new createjs.Shape;b.graphics.beginFill("#000000").drawRect(-c,-e,k,p);a.hitArea=b;return a}
function randomFloatBetween(a,b,c){"undefined"===typeof c&&(c=2);return parseFloat(Math.min(a+Math.random()*(b-a),b).toFixed(c))}function shuffle(a){for(var b=a.length,c,e;0!==b;)e=Math.floor(Math.random()*b),--b,c=a[b],a[b]=a[e],a[e]=c;return a}function formatTime(a,b,c){a/=1E3;var e=Math.floor(a/60);a=parseFloat(a-60*e).toFixed(c);c="";b||(c=10>e?c+("0"+e+":"):c+(e+":"));return 10>a?c+("0"+a):c+a}
function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(a){for(var b=a.length,c,e;0<b;)e=Math.floor(Math.random()*b),b--,c=a[b],a[b]=a[e],a[e]=c;return a}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0);a.dispatchEvent(b)}}};
(function(){function a(c){var e={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};c=c||window.event;c.type in e?document.body.className=e[c.type]:(document.body.className=this[b]?"hidden":"visible","hidden"===document.body.className?(s_oMain.stopUpdate(),s_bFocus=!1):(s_oMain.startUpdate(),s_bFocus=!0))}var b="hidden";b in document?document.addEventListener("visibilitychange",a):(b="mozHidden")in document?document.addEventListener("mozvisibilitychange",
a):(b="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(b="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var b=window.location.search.substring(1).split("&"),c=0;c<b.length;c++){var e=b[c].split("=");if(e[0]==a)return e[1]}}function setVolumeSfx(a,b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(b)}function setVolumeMusic(a,b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aMusic[a].volume(b)}function playSfxSound(a,b,c){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(b),s_aSounds[a].loop(c),s_aSounds[a]):null}
function playMusicSound(a,b,c){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aMusic[a].play(),s_aMusic[a].volume(b),s_aMusic[a].loop(c),s_aMusic[a]):null}function stopSfxSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}function stopMusicound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aMusic[a].stop()}function setSfxVolume(a,b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(b)}
function setMusicVolume(a,b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aMusic[a].volume(b)}function setSfxMute(a,b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].mute(b)}function setMusicMute(a,b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aMusic[a].mute(b)}function isSoundPlaying(a){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?s_aSounds[a].playing():!1}function isMusicPlaying(a){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?s_aMusic[a].playing():!1}
function muteAllSfx(a){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)for(var b in s_aSounds)s_aSounds[b].mute(a)}function muteAllMusic(a){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)for(var b in s_aMusic)s_aMusic[b].mute(a)}function saveItem(a,b){s_bStorageAvailable&&localStorage.setItem(a,b)}function getItem(a){return s_bStorageAvailable?localStorage.getItem(a):null}
function fullscreenHandler(){ENABLE_FULLSCREEN&&!1!==screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut())}if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a={},b,c,e,k,p,n;this.init=function(m,d,g){b={};e=c=0;k=m;p=d;n=g};this.addSprite=function(m,d){if(!a.hasOwnProperty(m)){var g=new Image;a[m]=b[m]={szPath:d,oSprite:g,bLoaded:!1};c++}};this.getSprite=function(m){return a.hasOwnProperty(m)?a[m].oSprite:null};this._onSpritesLoaded=function(){c=0;p.call(n)};this._onSpriteLoaded=function(){k.call(n);++e===c&&this._onSpritesLoaded()};this.loadSprites=function(){for(var m in b)b[m].oSprite.oSpriteLibrary=this,b[m].oSprite.szKey=
m,b[m].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},b[m].oSprite.onerror=function(d){var g=d.currentTarget;setTimeout(function(){b[g.szKey].oSprite.src=b[g.szKey].szPath},500)},b[m].oSprite.src=b[m].szPath};this.setLoaded=function(m){a[m].bLoaded=!0};this.isLoaded=function(m){return a[m].bLoaded};this.getNumSprites=function(){return c}}
var CANVAS_WIDTH=1500,CANVAS_HEIGHT=768,EDGEBOARD_X=180,EDGEBOARD_Y=20,FPS=30,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,FONT_GAME="TradeGothic",STATE_LOADING=0,STATE_MENU=1,STATE_GAME=2,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_BUT_YES_DOWN=2,ON_PLAYER_FALL=3,ON_ELEMENT_HIDE=4,ON_ELEMENT_CHECK_COLLISION=5,ON_BACK_MENU=6,ON_RESTART=7,ON_BUT_END_TWEEN_X=8,ON_END_COUNTDOWN=9,ON_BUT_END_TWEEN=10,PLAYER_ANIM_RUN=0,PLAYER_ANIM_FALL=1,PLAYER_ANIM_LEFT=2,PLAYER_ANIM_LEFT_OUT=3,PLAYER_ANIM_RIGHT=4,PLAYER_ANIM_RIGHT_OUT=
5,STARTING_STANDS_SCALE_BONUS=.74,ELEMENT_ENEMY=0,ELEMENT_BOOSTER=1,ELEMENT_COIN=2,ELEMENT_INVULNERABILITY=3,MODE_EASY=0,MODE_EASY_MEDIUM=1,MODE_MEDIUM=2,MODE_MEDIUM_HARD=3,MODE_HARD=4,SCORE_NEEDED_FOR_EASY_MEDIUM,SCORE_NEEDED_FOR_MEDIUM,SCORE_NEEDED_FOR_MEDIUM_HARD,SCORE_NEEDED_FOR_HARD,GATE_FINAL_Y=1200,TIME_GATE_RUN=3E3,HERO_ACCELERATION,HERO_FRICTION,MAX_HERO_SPEED,MIN_START_X=CANVAS_WIDTH/2-50,MAX_START_X=CANVAS_WIDTH/2+50,MIN_ARRIVAL_X=-300,START_X_INTERVAL=MAX_START_X-MIN_START_X,MAX_ARRIVAL_X=
CANVAS_WIDTH+300,ARRIVAL_X_INTERVAL=MAX_ARRIVAL_X-MIN_ARRIVAL_X,MIN_PLAYER_X=180,MAX_PLAYER_X=CANVAS_WIDTH-180,DIST_X_FOR_GATE_ANIM=250,MAX_ROT_FIELD=4,COLLECT_SCORE,BOOST_SCORE_MULTIPLIER,SPAWN_POWER_UP_PERC,GAME_NAME="downhill_christmas",ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION,SOUNDTRACK_VOLUME_IN_GAME=.4,POWER_UP_SPEED_FACTOR=1.5,POWER_UP_ACCELERATION_TIME=1500,POWER_UP_DURATION_TIME=3E3,INVULNERABILITY_DURATION_TIME;
function CPreloader(){var a,b,c,e,k,p,n,m,d;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.loadSprites();d=new createjs.Container;s_oStage.addChild(d)};this.unload=function(){d.removeAllChildren()};this._onImagesLoaded=function(){};this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};
this.attachSprites=function(){var g=new createjs.Shape;g.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.addChild(g);g=s_oSpriteLibrary.getSprite("200x200");n=createBitmap(g);n.regX=.5*g.width;n.regY=.5*g.height;n.x=CANVAS_WIDTH/2;n.y=CANVAS_HEIGHT/2-80;d.addChild(n);m=new createjs.Shape;m.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(n.x-100,n.y-100,200,200,10);d.addChild(m);n.mask=m;g=s_oSpriteLibrary.getSprite("progress_bar");e=createBitmap(g);e.x=CANVAS_WIDTH/2-g.width/
2;e.y=CANVAS_HEIGHT/2+70;d.addChild(e);a=g.width;b=g.height;k=new createjs.Shape;k.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(e.x,e.y,1,b);d.addChild(k);e.mask=k;c=new createjs.Text("","30px "+FONT_GAME,"#fff");c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT/2+120;c.textBaseline="alphabetic";c.textAlign="center";d.addChild(c);p=new createjs.Shape;p.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.addChild(p);createjs.Tween.get(p).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(p);
d.removeChild(p)})};this.refreshLoader=function(g){c.text=g+"%";100===g&&(s_oMain._allResourcesLoaded(),c.visible=!1,e.visible=!1);k.graphics.clear();g=Math.floor(g*a/100);k.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(e.x,e.y,g,b)};this._init()}
function CMain(a){var b,c,e=0,k=0,p=STATE_LOADING,n,m;this.initContainer=function(){var d=document.getElementById("canvas");s_oStage=new createjs.Stage(d);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage);s_bMobile=isMobile();!1===s_bMobile&&s_oStage.enableMouseOver(20);s_iPrevTime=(new Date).getTime();createjs.Ticker.framerate=FPS;createjs.Ticker.on("tick",this._update);navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;n=new CPreloader};
this.setBestScore=function(d){if(!s_bStorageAvailable)return null;var g=getItem(GAME_NAME+"_best_score");(0===g||g<d)&&saveItem(GAME_NAME+"_best_score",d)};this.getBestScore=function(){if(!s_bStorageAvailable)return null;var d=getItem(GAME_NAME+"_best_score");return null===d?0:d};this.clearLocalStorage=function(){if(s_bStorageAvailable)for(var d=0;d<localStorage.length;){var g=localStorage.key(d);-1!==g.indexOf(GAME_NAME)?localStorage.removeItem(g):d++}};this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&
!1!==s_bMobile||this._initSounds();this._loadImages();b=c=!0};this.soundLoaded=function(){e++;n.refreshLoader(Math.floor(e/k*100))};this._initSounds=function(){s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"click",loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",filename:"skiing_direction",loop:!1,volume:1,ingamename:"skiing_direction"});s_aSoundsInfo.push({path:"./sounds/",filename:"falling",loop:!1,volume:1,ingamename:"falling"});s_aSoundsInfo.push({path:"./sounds/",
filename:"countdown",loop:!1,volume:1,ingamename:"countdown"});s_aSoundsInfo.push({path:"./sounds/",filename:"go",loop:!1,volume:1,ingamename:"go"});s_aSoundsInfo.push({path:"./sounds/",filename:"hit_gate",loop:!1,volume:1,ingamename:"hit_gate"});s_aSoundsInfo.push({path:"./sounds/",filename:"skiing",loop:!1,volume:1,ingamename:"skiing"});s_aSoundsInfo.push({path:"./sounds/",filename:"boost",loop:!1,volume:1,ingamename:"boost"});s_aSoundsInfo.push({path:"./sounds/",filename:"invulnerability",loop:!1,
volume:1,ingamename:"invulnerability"});s_aSoundsInfo.push({path:"./sounds/",filename:"collect_present",loop:!1,volume:1,ingamename:"collect_present"});k+=s_aSoundsInfo.length;s_aSounds=[];for(var d=0;d<s_aSoundsInfo.length;d++)this.tryToLoadSound(s_aSoundsInfo[d],!1);s_aMusicInfo=[];s_aMusicInfo.push({path:"./sounds/",filename:"game_over",loop:!1,volume:1,ingamename:"game_over"});s_aMusicInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});k+=s_aMusicInfo.length;
s_aMusic=[];for(d=0;d<s_aMusicInfo.length;d++)this.tryToLoadMusic(s_aMusicInfo[d],!1)};this.tryToLoadSound=function(d,g){setTimeout(function(){s_aSounds[d.ingamename]=new Howl({src:[d.path+d.filename+".mp3"],autoplay:!1,preload:!0,loop:d.loop,volume:d.volume,onload:s_oMain.soundLoaded,onloaderror:function(w,h){for(var u=0;u<s_aSoundsInfo.length;u++)if(w===s_aSounds[s_aSoundsInfo[u].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[u],!0);break}},onplayerror:function(w){for(var h=0;h<
s_aSoundsInfo.length;h++)if(w===s_aSounds[s_aSoundsInfo[h].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[h].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[h].ingamename].play()});break}}})},g?200:0)};this.tryToLoadMusic=function(d,g){setTimeout(function(){s_aMusic[d.ingamename]=new Howl({src:[d.path+d.filename+".mp3"],autoplay:!1,preload:!0,loop:d.loop,volume:d.volume,onload:s_oMain.soundLoaded,onloaderror:function(w,h){for(var u=0;u<s_aMusicInfo.length;u++)if(w===s_aMusic[s_aMusicInfo[u].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aMusicInfo[u],
!0);break}},onplayerror:function(w){for(var h=0;h<s_aMusicInfo.length;h++)if(w===s_aMusic[s_aMusicInfo[h].ingamename]._sounds[0]._id){s_aMusic[s_aMusicInfo[h].ingamename].once("unlock",function(){s_aMusic[s_aMusicInfo[h].ingamename].play();"soundtrack"===s_aMusicInfo[h].ingamename&&null!==s_oGame&&setVolumeMusic("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},g?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play",
"./sprites/but_play.png");s_oSpriteLibrary.addSprite("but_continue","./sprites/but_continue.png");s_oSpriteLibrary.addSprite("but_next","./sprites/but_next.png");s_oSpriteLibrary.addSprite("but_prev","./sprites/but_prev.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("music_icon","./sprites/music_icon.png");s_oSpriteLibrary.addSprite("msg_box_wide",
"./sprites/msg_box_wide.png");s_oSpriteLibrary.addSprite("msg_box_help","./sprites/msg_box_help.png");s_oSpriteLibrary.addSprite("msg_box_small","./sprites/msg_box_small.png");s_oSpriteLibrary.addSprite("bg_game","./sprites/bg_game.jpg");s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png");s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.png");s_oSpriteLibrary.addSprite("but_fullscreen",
"./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("but_settings","./sprites/but_settings.png");s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.png");s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");s_oSpriteLibrary.addSprite("but_pause","./sprites/but_pause.png");s_oSpriteLibrary.addSprite("key_0","./sprites/key_0.png");s_oSpriteLibrary.addSprite("key_1","./sprites/key_1.png");s_oSpriteLibrary.addSprite("but_left","./sprites/but_left.png");s_oSpriteLibrary.addSprite("but_right",
"./sprites/but_right.png");s_oSpriteLibrary.addSprite("logo_menu","./sprites/logo_menu.png");s_oSpriteLibrary.addSprite("score_panel","./sprites/score_panel.png");s_oSpriteLibrary.addSprite("sponsor_0","./sprites/sponsor_0.png");s_oSpriteLibrary.addSprite("sponsor_1","./sprites/sponsor_1.png");s_oSpriteLibrary.addSprite("countdown_0","./sprites/countdown_0.png");s_oSpriteLibrary.addSprite("countdown_1","./sprites/countdown_1.png");s_oSpriteLibrary.addSprite("countdown_2","./sprites/countdown_2.png");
s_oSpriteLibrary.addSprite("countdown_3","./sprites/countdown_3.png");s_oSpriteLibrary.addSprite("gate_0","./sprites/gate_0.png");s_oSpriteLibrary.addSprite("gate_1","./sprites/gate_1.png");s_oSpriteLibrary.addSprite("help_santa","./sprites/help_santa.jpg");s_oSpriteLibrary.addSprite("parallax_0","./sprites/parallax_0.png");s_oSpriteLibrary.addSprite("parallax_1","./sprites/parallax_1.png");for(var d=0;29>=d;d++)s_oSpriteLibrary.addSprite("field_loop_"+d,"./sprites/field_loop/field_loop_"+d+".png");
for(d=0;30>d;d++)s_oSpriteLibrary.addSprite("santa_falling_"+d,"./sprites/player_santa/falling/santa_falling_"+d+".png");for(d=0;19>d;d++)s_oSpriteLibrary.addSprite("santa_running_"+d,"./sprites/player_santa/running/santa_running_"+d+".png"),s_oSpriteLibrary.addSprite("santaboost_running_"+d,"./sprites/player_santa_boost/running/santaboost_running_"+d+".png");for(d=0;8>d;d++)s_oSpriteLibrary.addSprite("santa_left_"+d,"./sprites/player_santa/turn_left/santa_left_"+d+".png"),s_oSpriteLibrary.addSprite("santa_right_"+
d,"./sprites/player_santa/turn_right/santa_right_"+d+".png"),s_oSpriteLibrary.addSprite("santaboost_left_"+d,"./sprites/player_santa_boost/turn_left/santaboost_left_"+d+".png"),s_oSpriteLibrary.addSprite("santaboost_right_"+d,"./sprites/player_santa_boost/turn_right/santaboost_right_"+d+".png");for(d=0;7>d;d++)s_oSpriteLibrary.addSprite("santa_left_out_"+d,"./sprites/player_santa/turn_left_out/santa_left_out_"+d+".png"),s_oSpriteLibrary.addSprite("santa_right_out_"+d,"./sprites/player_santa/turn_right_out/santa_right_out_"+
d+".png"),s_oSpriteLibrary.addSprite("santaboost_left_out_"+d,"./sprites/player_santa_boost/turn_left_out/santaboost_left_out_"+d+".png"),s_oSpriteLibrary.addSprite("santaboost_right_out_"+d,"./sprites/player_santa_boost/turn_right_out/santaboost_right_out_"+d+".png");for(d=0;19>d;d++)s_oSpriteLibrary.addSprite("santa_hat_"+d,"./sprites/santa_hat/santa_hat_"+d+".png"),s_oSpriteLibrary.addSprite("santa_boost_hat_"+d,"./sprites/santa_boost_hat/santa_boost_hat_"+d+".png");for(d=0;45>d;d++)s_oSpriteLibrary.addSprite("help_santa_"+
d,"./sprites/help/help_santa_"+d+".jpg");for(d=0;50>=d;d++)s_oSpriteLibrary.addSprite("booster_"+d,"./sprites/booster/booster_"+d+".png");for(d=0;50>=d;d++)s_oSpriteLibrary.addSprite("present_0_"+d,"./sprites/present_0/present_0_"+d+".png"),s_oSpriteLibrary.addSprite("present_1_"+d,"./sprites/present_1/present_1_"+d+".png");for(d=0;50>=d;d++)s_oSpriteLibrary.addSprite("star_"+d,"./sprites/star/star_"+d+".png");for(d=1;22>=d;d++)s_oSpriteLibrary.addSprite("particle_stars_"+d,"./sprites/particle_stars/particle_stars_"+
d+".png");s_oSpriteLibrary.addSprite("booster_icon","./sprites/booster_icon.png");s_oSpriteLibrary.addSprite("star_icon","./sprites/star_icon.png");k+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){e++;n.refreshLoader(Math.floor(e/k*100))};this._onAllImagesLoaded=function(){};this._allResourcesLoaded=function(){muteAllMusic(!s_bMusicActive);muteAllSfx(!s_bAudioActive);n.unload();try{saveItem("ls_available","ok")}catch(d){s_bStorageAvailable=!1}s_oSoundTrack=
playMusicSound("soundtrack",1,!0);s_oMain.gotoMenu()};this.gotoMenu=function(){new CMenu;p=STATE_MENU};this.gotoGame=function(){s_oGame=m=new CGame;p=STATE_GAME};this.stopUpdateNoBlockAndTick=function(){c=!1};this.startUpdateNoBlockAndTick=function(){c=!0};this.stopUpdateNoBlock=function(){b=!1;createjs.Ticker.paused=!0};this.startUpdateNoBlock=function(){s_iPrevTime=(new Date).getTime();b=!0;createjs.Ticker.paused=!1};this.stopUpdate=function(){b=!1;createjs.Ticker.paused=!0;$("#block_game").css("display",
"block");if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)muteAllSfx(!0),muteAllMusic(!0)};this.startUpdate=function(){0==s_bGamePaused&&(s_iPrevTime=(new Date).getTime(),b=!0,createjs.Ticker.paused=!1);$("#block_game").css("display","none");if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)s_bAudioActive&&muteAllSfx(!1),s_bMusicActive&&muteAllMusic(!1)};this.isUpdating=function(){return b};this._update=function(d){if(!1!==b){var g=(new Date).getTime();s_iTimeElaps=g-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;
s_iPrevTime=g;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);p===STATE_GAME&&c&&m.update();void 0!==s_oStage&&s_oStage.update(d)}};s_oMain=this;HERO_ACCELERATION=a.hero_acceleration;HERO_FRICTION=a.hero_friction;MAX_HERO_SPEED=a.max_hero_speed;COLLECT_SCORE=a.present_score_amount;SCORE_NEEDED_FOR_EASY_MEDIUM=10*COLLECT_SCORE;SCORE_NEEDED_FOR_MEDIUM=20*COLLECT_SCORE;SCORE_NEEDED_FOR_MEDIUM_HARD=40*COLLECT_SCORE;SCORE_NEEDED_FOR_HARD=60*COLLECT_SCORE;SPAWN_POWER_UP_PERC=a.spawn_power_up_perc;
INVULNERABILITY_DURATION_TIME=a.invulnerability_duration_time;BOOST_SCORE_MULTIPLIER=a.boost_score_multiplier;ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;s_bAudioActive=a.audio_enable_on_startup;s_bMusicActive=a.music_enable_on_startup;this.initContainer()}
var s_bMobile,s_bAudioActive=!0,s_bMusicActive=!0,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_bGamePaused=!1,s_oSoundTrack=null,s_oDrawLayer,s_oStage,s_oMain=null,s_oSpriteLibrary,s_szPlayerType="santa",s_bFullscreen=!1,s_bStorageAvailable=!0,s_aMusicInfo,s_aSoundsInfo,s_aSounds,s_aMusic,s_oGame=null;
function CTextButton(a,b,c,e,k,p,n,m){var d,g,w,h,u,v,q,x,r,y,f;this._init=function(t,G,A,z,E,B,P,L){d=!1;h=[];u=[];f=createBitmap(A);g=A.width;w=A.height;y=new createjs.Text(z,P+"px "+E,B);y.textAlign="center";y.textBaseline="alphabetic";y.lineWidth=.9*g;y.x=A.width/2;y.y=Math.floor(A.height/2)+15;r=new createjs.Container;r.x=t;r.y=G;r.regX=A.width/2;r.regY=A.height/2;s_bMobile||(r.cursor="pointer");r.addChild(f,y);!1!==L&&s_oStage.addChild(r);this._initListener()};this.unload=function(){r.off("mousedown",
q);r.off("pressup",x);s_oStage.removeChild(r)};this.setVisible=function(t){r.visible=t};this.setAlign=function(t){y.textAlign=t};this.enable=function(){d=!1;f.filters=[];f.cache(0,0,g,w)};this.disable=function(){d=!0;var t=(new createjs.ColorMatrix).adjustSaturation(-100).adjustBrightness(40);f.filters=[new createjs.ColorMatrixFilter(t)];f.cache(0,0,g,w)};this._initListener=function(){q=r.on("mousedown",this.buttonDown);x=r.on("pressup",this.buttonRelease)};this.addEventListener=function(t,G,A){h[t]=
G;u[t]=A};this.addEventListenerWithParams=function(t,G,A,z){h[t]=G;u[t]=A;v=z};this.buttonRelease=function(){d||(playSfxSound("click",1,!1),r.scaleX=1,r.scaleY=1,h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(u[ON_MOUSE_UP],v))};this.buttonDown=function(){d||(r.scaleX=.9,r.scaleY=.9,h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(u[ON_MOUSE_DOWN]))};this.setPosition=function(t,G){r.x=t;r.y=G};this.changeText=function(t){y.text=t};this.setX=function(t){r.x=t};this.setY=function(t){r.y=t};this.getButtonImage=function(){return r};
this.getX=function(){return r.x};this.getY=function(){return r.y};this.getSprite=function(){return r};this._init(a,b,c,e,k,p,n,m);return this}
function CGfxButton(a,b,c,e){var k,p,n,m,d=[],g,w,h;this._init=function(u,v,q){k=!1;p=1;n=[];m=[];h=createBitmap(q);h.x=u;h.y=v;h.regX=q.width/2;h.regY=q.height/2;h.cursor="pointer";e.addChild(h);this._initListener()};this.unload=function(){h.off("mousedown",g);h.off("pressup",w);e.removeChild(h)};this.setVisible=function(u){h.visible=u};this._initListener=function(){g=h.on("mousedown",this.buttonDown);w=h.on("pressup",this.buttonRelease)};this.addEventListener=function(u,v,q){n[u]=v;m[u]=q};this.addEventListenerWithParams=
function(u,v,q,x){n[u]=v;m[u]=q;d=x};this.enable=function(){k=!1};this.disable=function(){k=!0};this.buttonRelease=function(){k||(playSfxSound("click",1,!1),h.scaleX=p,h.scaleY=p,n[ON_MOUSE_UP]&&n[ON_MOUSE_UP].call(m[ON_MOUSE_UP],d))};this.buttonDown=function(){k||(h.scaleX=.9*p,h.scaleY=.9*p,n[ON_MOUSE_DOWN]&&n[ON_MOUSE_DOWN].call(m[ON_MOUSE_DOWN],d))};this.setPosition=function(u,v){h.x=u;h.y=v};this.setX=function(u){h.x=u};this.setY=function(u){h.y=u};this.setScale=function(u){p=u;h.scaleX=h.scaleY=
u};this.getButtonImage=function(){return h};this.getX=function(){return h.x};this.getY=function(){return h.y};this._init(a,b,c)}
function CSideGfxButton(a,b,c,e,k){var p,n=b,m,d,g,w,h=[],u,v,q;this._init=function(x,r,y,f){p=!1;g=[];w=[];q=createBitmap(f);q.y=y;d=f.width;x?(q.x=-f.width,q.regX=0):(q.x=CANVAS_WIDTH+f.width,q.regX=f.width);m=q.x;q.regY=f.height/2;q.cursor="pointer";k.addChild(q);this._initListener()};this.unload=function(){q.off("mousedown",u);q.off("pressup",v);k.removeChild(q)};this.setVisible=function(x){q.visible=x};this._initListener=function(){u=q.on("mousedown",this.buttonDown);v=q.on("pressup",this.buttonRelease)};
this.addEventListener=function(x,r,y){g[x]=r;w[x]=y};this.addEventListenerWithParams=function(x,r,y,f){g[x]=r;w[x]=y;h=f};this.enable=function(){p=!1};this.disable=function(){p=!0};this.buttonRelease=function(){p||(playSfxSound("click",1,!1),q.scaleX=1,q.scaleY=1,g[ON_MOUSE_UP]&&g[ON_MOUSE_UP].call(w[ON_MOUSE_UP],h))};this.buttonDown=function(){p||(q.scaleX=.9,q.scaleY=.9,g[ON_MOUSE_DOWN]&&g[ON_MOUSE_DOWN].call(w[ON_MOUSE_DOWN],h))};this.setPosition=function(x,r){q.x=x;q.y=r};this.setX=function(x){q.x=
x};this.setY=function(x){q.y=x};this.resetX=function(){q.x=a?-d:CANVAS_WIDTH+d};this.setFinalX=function(x){n=x;m=a?n-d:n+d};this.tweenFinalX=function(){createjs.Tween.get(q).to({x:n},300,createjs.Ease.quartOut).call(function(){g[ON_BUT_END_TWEEN_X]&&g[ON_BUT_END_TWEEN_X].call(w[ON_BUT_END_TWEEN_X])})};this.tweenStartX=function(x){createjs.Tween.get(q).wait(x).to({x:m},300,createjs.Ease.quartOut)};this.getButtonImage=function(){return q};this.getX=function(){return q.x};this.getY=function(){return q.y};
this._init(a,b,c,e);return this}
function CSideToggle(a,b,c,e,k,p,n){var m,d,g=c,w,h,u,v;this._init=function(q,x,r,y,f){h=[];u=[];d=!1;x=0;!1===q&&(x=y.width/2);var t=new createjs.SpriteSheet({images:[y],frames:{width:y.width/2,height:y.height,regX:x,regY:y.height/2},animations:{state_true:[0],state_false:[1]}});m=f;v=createSprite(t,"state_"+m,x,y.height/2,y.width/2,y.height);v.x=q?-y.width/2:CANVAS_WIDTH+y.width/2;w=v.x;v.y=r;v.stop();v.cursor="pointer";n.addChild(v);this._initListener()};this.unload=function(){v.off("mousedown",
this.buttonDown);v.off("pressup",this.buttonRelease);n.removeChild(v)};this._initListener=function(){v.on("mousedown",this.buttonDown);v.on("pressup",this.buttonRelease)};this.addEventListener=function(q,x,r){h[q]=x;u[q]=r};this.setActive=function(q){m=q;v.gotoAndStop("state_"+m)};this.buttonRelease=function(){d||(v.scaleX=1,v.scaleY=1,playSfxSound("click",1,!1),m=!m,v.gotoAndStop("state_"+m),h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(u[ON_MOUSE_UP],m))};this.buttonDown=function(){d||(v.scaleX=.9,v.scaleY=
.9,h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(u[ON_MOUSE_DOWN]))};this.disable=function(){d=!0};this.enable=function(){d=!1};this.setPosition=function(q,x){v.x=q;v.y=x};this.setY=function(q){v.y=q};this.setFinalX=function(q){g=q};this.tweenFinalX=function(){createjs.Tween.get(v).wait(b).to({x:g},300,createjs.Ease.quartOut).call(function(){h[ON_BUT_END_TWEEN_X]&&h[ON_BUT_END_TWEEN_X].call(u[ON_BUT_END_TWEEN_X])})};this.tweenStartX=function(q){createjs.Tween.get(v).wait(q).to({x:w},300,createjs.Ease.quartOut)};
this.getButtonImage=function(){return v};this._init(a,c,e,k,p)}
function CMenu(){var a,b,c,e,k,p,n,m,d,g,w,h,u,v,q,x,r=null,y=null;this._init=function(){d=!0;g=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(g);w=new CGfxButton(CANVAS_WIDTH/2+350,CANVAS_HEIGHT/2+200,s_oSpriteLibrary.getSprite("but_play"),s_oStage);w.addEventListener(ON_MOUSE_UP,this._onButPlaySingle,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){var f=s_oSpriteLibrary.getSprite("audio_icon");n=CANVAS_WIDTH;m=f.height/2+10;h=new CSideToggle(!1,0,n-s_iOffsetX,m+s_iOffsetY,
f,s_bAudioActive,s_oStage);h.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);k=CANVAS_WIDTH;p=m+f.height+10;u=new CSideToggle(!1,0,k-s_iOffsetX,p+s_iOffsetY,s_oSpriteLibrary.getSprite("music_icon"),s_bMusicActive,s_oStage);u.addEventListener(ON_MOUSE_UP,this._onMusicToggle,this);a=CANVAS_WIDTH;b=p+f.height+10;h.tweenFinalX();u.tweenFinalX()}else a=CANVAS_WIDTH,b=f.height/2+10;f=s_oSpriteLibrary.getSprite("but_credits");c=0;e=f.height/2+10;v=new CSideGfxButton(!0,c+s_iOffsetX,e+s_iOffsetY,f,
s_oStage);v.addEventListener(ON_MOUSE_UP,this._onButCreditsRelease,this);v.addEventListener(ON_BUT_END_TWEEN_X,this._onButEndTween,this);f=window.document;var t=f.documentElement;r=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen;y=f.exitFullscreen||f.mozCancelFullScreen||f.webkitExitFullscreen||f.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(r=!1);r&&screenfull.isEnabled&&(f=s_oSpriteLibrary.getSprite("but_fullscreen"),x=new CSideToggle(!1,200,a-s_iOffsetX,
b+s_iOffsetY,f,s_bFullscreen,s_oStage),x.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this),x.tweenFinalX());f=s_oSpriteLibrary.getSprite("logo_menu");t=createBitmap(f);t.regX=f.width/2;t.x=CANVAS_WIDTH/2;t.y=40;s_oStage.addChild(t);s_bStorageAvailable||new CAlertSavingBox(TEXT_ERR_LS,s_oStage);q=new createjs.Shape;q.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(q);createjs.Tween.get(q).to({alpha:0},400).call(function(){q.visible=!1});v.tweenFinalX();
setMusicVolume("soundtrack",1)};this.unload=function(){w.unload();v.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)h.unload(),h=null,u.unload();r&&screenfull.isEnabled&&x.unload();s_oStage.removeAllChildren();s_oMenu=null};this.refreshButtonPos=function(){if(!d){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)h.setPosition(n-s_iOffsetX,s_iOffsetY+m),u.setPosition(k-s_iOffsetX,s_iOffsetY+p);r&&screenfull.isEnabled&&x.setPosition(a-s_iOffsetX,b+s_iOffsetY);v.setPosition(c+s_iOffsetX,e+s_iOffsetY)}};
this._onButPlaySingle=function(){s_oMenu.unload();s_oMain.gotoGame();$(s_oMain).trigger("start_session")};this._onButCreditsRelease=function(){new CCreditsPanel};this._onButEndTween=function(){d=!1};this._onAudioToggle=function(){muteAllSfx(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onMusicToggle=function(){muteAllMusic(s_bMusicActive);s_bMusicActive=!s_bMusicActive};this.resetFullscreenBut=function(){r&&screenfull.isEnabled&&x.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?
y.call(window.document):r.call(window.document.documentElement);sizeHandler()};s_oMenu=this;this._init()}
var s_oMenu=null,CGameBase=function(a){this._bUpdate;this._bStartEnemySpawn;this._bStartRace;this._bKeyDownLeft;this._bKeyDownRight;this._bGameOver;this._bPlayerInvulnerable;this._iCurScore;this._fOffsetYBg;this._iCurTrembleIndex;this._iIdInterval;this._aGate;this._aTrembleSequence;this._iCurDifficulty;this._oBg;this._oContainerParallax;this._oField;this._oInterface;this._oContainerField;this._oContainerElements;this._oCountdown;this._oPlayer;this._oHelpPanel;this._oEndPanel;this._oShapePlayer;this._fCameraAcc};
CGameBase.prototype._init=function(){this._bUpdate=!1;this._aTrembleSequence=[{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0},{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0}];var a=s_oSpriteLibrary.getSprite("bg_game");this._oContainerField=new createjs.Container;this._oContainerField.x=a.width/2;this._oContainerField.y=CANVAS_HEIGHT/2;this._oContainerField.regX=a.width/2;this._oContainerField.regY=420;s_oStage.addChild(this._oContainerField);this._oBg=
createBitmap(a);this._oBg.x=-50;this._oContainerField.addChild(this._oBg);this._oContainerParallax=new createjs.Container;this._oContainerField.addChild(this._oContainerParallax);a=createBitmap(s_oSpriteLibrary.getSprite("parallax_0"));a.x=-15;a.y=100;this._oContainerParallax.addChild(a);a=createBitmap(s_oSpriteLibrary.getSprite("parallax_1"));a.x=825;a.y=150;this._oContainerParallax.addChild(a);this._oField=new CField(-50,131,this._oContainerField);this._oContainerElements=new createjs.Container;
this._oContainerField.addChild(this._oContainerElements);this._oCountdown=new CCountdownController(CANVAS_WIDTH/2,CANVAS_HEIGHT/2-150,s_oStage);this._oInterface=new CInterface;this._oShapePlayer=new createjs.Shape;this._oShapePlayer.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,0,0);this._oShapePlayer.alpha=.5;s_oStage.addChild(this._oShapePlayer);this._oHelpPanel=new CHelpPanel;this._oHelpPanel.show();this._oEndPanel=new CEndPanel;var b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,
0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(b);createjs.Tween.get(b).to({alpha:0},400).call(function(){b.visible=!1})};CGameBase.prototype.unload=function(){this._bUpdate=!1;this._oInterface.unload();this._oCountdown.unload();stopSfxSound("skiing");s_oStage.removeAllChildren();s_oGame=null};CGameBase.prototype.reset=function(){this._resetValue();this._aGate=[];this._fOffsetYBg=-.002;this._resetObjects();setMusicVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME);$(s_oMain).trigger("start_level",1)};
CGameBase.prototype.restart=function(){$(s_oMain).trigger("restart_level",1);this._removeElements();this.reset();this.startCountdown()};CGameBase.prototype.refreshButtonPos=function(){this._oInterface.refreshButtonPos()};
CGameBase.prototype.onKeyDown=function(a){a||(a=window.event);a.preventDefault();if(!this._bUpdate||this._bGameOver)return!1;this._oPlayer.resetMovGates();switch(a.keyCode){case 37:return this._bKeyDownRight=!1,this._bKeyDownLeft=!0,this._oPlayer.moveLeft(!0),a.preventDefault(),!1;case 39:return this._bKeyDownLeft=!1,this._bKeyDownRight=!0,this._oPlayer.moveRight(!0),a.preventDefault(),!1}};
CGameBase.prototype.onKeyUp=function(a){a||(a=window.event);if(!this._bUpdate||this._bGameOver)return a.preventDefault(),!1;a||(a=window.event);this._bKeyDownRight=this._bKeyDownLeft=!1;switch(a.keyCode){case 37:return this._oPlayer.moveLeft(!1),a.preventDefault(),!1;case 39:return this._oPlayer.moveRight(!1),a.preventDefault(),!1}};
CGameBase.prototype.mobileMoveKeyDown=function(a){this._bUpdate&&!this._bGameOver&&(this._oPlayer.resetMovGates(),a?(this._bKeyDownRight=!1,this._bKeyDownLeft=!0,this._oPlayer.moveLeft(!0)):(this._bKeyDownLeft=!1,this._bKeyDownRight=!0,this._oPlayer.moveRight(!0)))};CGameBase.prototype.mobileMoveKeyUp=function(a){this._bUpdate&&!this._bGameOver&&(this._bKeyDownRight=this._bKeyDownLeft=!1,a?this._oPlayer.moveLeft(!1):this._oPlayer.moveRight(!1))};
CGameBase.prototype.startCountdown=function(){this._oPlayer.show();this._oField.show();this._oCountdown.start();this._bUpdate=!0};CGameBase.prototype.startRace=function(){this._bStartEnemySpawn=this._bStartRace=!0};CGameBase.prototype.onExitFromHelp=function(){this.startCountdown()};
CGameBase.prototype.tremble=function(){var a=this._aTrembleSequence[this._iCurTrembleIndex];this._oContainerField.x+=a.x;this._oContainerField.y+=a.y;this._iCurTrembleIndex++;this._iCurTrembleIndex===this._aTrembleSequence.length&&(this._iCurTrembleIndex=0,clearInterval(this._iIdInterval))};CGameBase.prototype.refreshScore=function(a){a=0>a?0:parseInt(a);this._iCurScore+=a;this._oInterface.refreshScore(this._iCurScore)};
CGameBase.prototype._manageElementsDepth=function(){this._oContainerElements.sortChildren(function(a,b,c){return a.y>b.y?1:a.y<b.y?-1:0})};CGameBase.prototype.endTrack=function(){this._bStartRace=!1};
CGameBase.prototype._onEndLevel=function(a){$(s_oMain).trigger("end_level",1);$(s_oMain).trigger("save_score",this._iCurScore);s_oMain.setBestScore(this._iCurScore);var b=this;setTimeout(function(){b._oPlayer.stopAnim();b._oField.stopAnim();b._stopElementsUpdate();b._oEndPanel.show(b._iCurScore.toString(),a)},500)};CGameBase.prototype.onExit=function(){this.unload();s_oMain.gotoMenu();$(s_oMain).trigger("show_interlevel_ad");$(s_oMain).trigger("end_session")};CGameBase.prototype.getPlayerX=function(){return this._oPlayer.getX()};
CGameBase.prototype._rotateScreen=function(){this._bKeyDownLeft&&this._oContainerField.rotation>-MAX_ROT_FIELD?(this._fCameraAcc-=.4,this._fCameraAcc<-MAX_ROT_FIELD&&(this._fCameraAcc=-MAX_ROT_FIELD)):this._bKeyDownRight&&this._oContainerField.rotation<MAX_ROT_FIELD?(this._fCameraAcc+=.4,this._fCameraAcc>MAX_ROT_FIELD&&(this._fCameraAcc=MAX_ROT_FIELD)):!1===this._bKeyDownLeft&&!1===this._bKeyDownRight&&(this._fCameraAcc/=1.1);this._oContainerField.rotation=this._fCameraAcc};
CGameBase.prototype.update=function(){this._oHelpPanel.isVisible()&&this._oHelpPanel.update();!1!==this._bUpdate&&(this._rotateScreen(),-60<this._oContainerParallax.y&&(this._oBg.y+=this._fOffsetYBg,this._oContainerParallax.y+=1.5*this._fOffsetYBg),this._oField.update(),this._oPlayer.update(),this._updateElements(),this._spawnElements())};
var CGame=function(a){this._iBoostSpeedMultiplier;this._iTimeElapsSpawn;this._aElements;this._iSpawnTime;this._iCurPatternIndex;this._oCurPattern;this._oAcceleration;this._oInvulnerability;this._oCoinSprite;this._oGateSprite;this._oParticleSprite;CGameBase.call(this,a);this._init()};CGame.prototype=Object.create(CGameBase.prototype);
CGame.prototype._init=function(){CGameBase.prototype._init();this._oPlayer=new CPlayerSanta(CANVAS_WIDTH/2,900,this._oContainerElements);this._oPlayer.addEventListener(ON_PLAYER_FALL,this._onEndLevel,this);this.reset();this._startGame()};
CGame.prototype._resetValue=function(){this._bPlayerInvulnerable=this._bStartRace=this._bStartEnemySpawn=this._bGameOver=this._bKeyDownRight=this._bKeyDownLeft=!1;this._iTimeElapsSpawn=this._iCurScore=0;this._iCurDifficulty=MODE_EASY;this._getNewPattern();this._iSpawnTime=1;this._fCameraAcc=this._iGameTime=0;this._iBoostSpeedMultiplier=1;this._oAcceleration={value:this._iBoostSpeedMultiplier};this._aElements=[];this._initCoinSprite();this._initParticleSprite();this._initGateSprite()};
CGame.prototype._initCoinSprite=function(){for(var a=[],b=0;2>b;b++)for(var c=0;50>=c;c++)a.push(s_oSpriteLibrary.getSprite("present_"+b+"_"+c));b=new createjs.SpriteSheet({images:a,frames:{width:a[0].width,height:a[0].height,regX:a[0].width/2,regY:a[0].height/2},animations:{start_0:0,anim_0:[0,50,"anim_0"],start_1:51,anim_1:[51,101,"anim_1"]}});this._oCoinSprite=createSprite(b,"start_0",a[0].width/2,a[0].height/2,a[0].width,a[0].height)};
CGame.prototype._initGateSprite=function(){var a={images:[s_oSpriteLibrary.getSprite("gate_0"),s_oSpriteLibrary.getSprite("gate_1")],frames:[[1,1,542,366,0,0,0],[545,1,542,366,0,0,0],[1089,1,542,366,0,0,0],[1,369,542,366,0,0,0],[545,369,542,366,0,0,0],[1089,369,542,366,0,0,0],[1,737,542,366,0,0,0],[545,737,542,366,0,0,0],[1089,737,542,366,0,0,0],[1,1105,542,366,0,0,0],[545,1105,542,366,0,0,0],[1089,1105,542,366,0,0,0],[1,1473,542,366,0,0,0],[545,1473,542,366,0,0,0],[1089,1473,542,366,0,0,0],[1,1,
542,366,1,0,0],[545,1,542,366,1,0,0],[1089,1,542,366,1,0,0],[1,369,542,366,1,0,0],[545,369,542,366,1,0,0],[1089,369,542,366,1,0,0],[1,737,542,366,1,0,0],[545,737,542,366,1,0,0],[1089,737,542,366,1,0,0],[1,1105,542,366,1,0,0],[545,1105,542,366,1,0,0],[1089,1105,542,366,1,0,0]],animations:{start:0,anim_right:[0,14,"end_right"],anim_left:[15,27,"end_left"],end_right:[14],end_left:[27]}};a=new createjs.SpriteSheet(a);this._oGateSprite=new createjs.Sprite(a,"start")};
CGame.prototype._initParticleSprite=function(){for(var a=[],b=1;22>=b;b++)a.push(s_oSpriteLibrary.getSprite("particle_stars_"+b));b=new createjs.SpriteSheet({images:a,frames:{width:a[0].width,height:a[0].height,regX:a[0].width/2,regY:a[0].height/2},animations:{stop:21,anim:[0,20,"stop"]}});this._oParticleSprite=createSprite(b,"stop",a[0].width/2,a[0].height/2,a[0].width,a[0].height)};
CGame.prototype._resetObjects=function(){this._oBg.y=-50;this._oContainerParallax.y=200;this._oPlayer.reset();this._oInterface.reset(0);this._oCountdown.reset();this._oField.reset()};CGame.prototype._removeElements=function(){for(var a=0;a<this._aGate.length;a++)this._aGate[a].unload();for(a=0;a<this._aElements.length;a++)this._aElements[a].unload()};
CGame.prototype._startGame=function(){this._oCountdown.addEventListener(ON_END_COUNTDOWN,this.startRace,this);this._oEndPanel.addEventListener(ON_RESTART,this.restart,this);this._oEndPanel.addEventListener(ON_BACK_MENU,this.onExit,this);this.setSpeed(this._iBoostSpeedMultiplier)};
CGame.prototype._spawnEnemy=function(a){var b=(a-MIN_ARRIVAL_X)/ARRIVAL_X_INTERVAL*START_X_INTERVAL+MIN_START_X;a=new CGate(this._oGateSprite.clone(),b,500,a,this._oContainerElements,this._iBoostSpeedMultiplier);a.addEventListener(ON_ELEMENT_CHECK_COLLISION,this.checkCollision,this);this._aGate.push(a)};
CGame.prototype._spawnBooster=function(a){a=new CPowerUp(ELEMENT_BOOSTER,(a-MIN_ARRIVAL_X)/ARRIVAL_X_INTERVAL*START_X_INTERVAL+MIN_START_X,500,a,this._oContainerElements,this._iBoostSpeedMultiplier);a.addEventListener(ON_ELEMENT_CHECK_COLLISION,this.checkBoosterCollision,this);this._aElements.push(a)};
CGame.prototype._spawnInvulnerability=function(a){a=new CPowerUp(ELEMENT_INVULNERABILITY,(a-MIN_ARRIVAL_X)/ARRIVAL_X_INTERVAL*START_X_INTERVAL+MIN_START_X,500,a,this._oContainerElements,this._iBoostSpeedMultiplier);a.addEventListener(ON_ELEMENT_CHECK_COLLISION,this.checkInvulnerabilityCollision,this);this._aElements.push(a)};
CGame.prototype._spawnCoin=function(a){var b=(a-MIN_ARRIVAL_X)/ARRIVAL_X_INTERVAL*START_X_INTERVAL+MIN_START_X;a=new CCoin(this._oCoinSprite.clone(),this._oParticleSprite.clone(),b,500,a,this._oContainerElements,this._iBoostSpeedMultiplier);a.addEventListener(ON_ELEMENT_CHECK_COLLISION,this.checkCoinCollision,this);this._aElements.push(a)};
CGame.prototype.checkInvulnerabilityCollision=function(a,b){if(!this._bGameOver&&this._oPlayer.getRect().intersects(a)){this._oInvulnerability&&createjs.Tween.removeTweens(this._oInvulnerability);this._oInvulnerability={value:0};var c=this;b.setVisible(!1);this._bPlayerInvulnerable=!0;this._oPlayer.enableInvulnerabilityAnim();createjs.Tween.get(this._oInvulnerability).to({value:INVULNERABILITY_DURATION_TIME},INVULNERABILITY_DURATION_TIME).call(function(){c._oPlayer.disableInvulnerabilityAnim();c._bPlayerInvulnerable=
!1});playSfxSound("invulnerability",1,!1);new CEncouragement(this._oPlayer.getX(),400,TEXT_INVULNERABLE,s_oStage)}};
CGame.prototype.checkBoosterCollision=function(a,b){if(!this._bGameOver&&this._oPlayer.getRect().intersects(a)){b.setVisible(!1);this._oAcceleration&&createjs.Tween.removeTweens(this._oAcceleration);this._oAcceleration={value:this._iBoostSpeedMultiplier};var c=this,e=createjs.Tween.get(this._oAcceleration).to({value:POWER_UP_SPEED_FACTOR},POWER_UP_ACCELERATION_TIME,createjs.cubucIn);this._oPlayer.enableBoostAnim(POWER_UP_ACCELERATION_TIME);e.wait(POWER_UP_DURATION_TIME).call(function(){c._oPlayer.disableBoostAnim(POWER_UP_ACCELERATION_TIME);
createjs.Tween.get(c._oAcceleration).to({value:1},POWER_UP_ACCELERATION_TIME,createjs.cubucOut).on("change",function(){c.setSpeed(c._oAcceleration.value)})});e.on("change",function(){c.setSpeed(c._oAcceleration.value)});playSfxSound("boost",1,!1);new CEncouragement(this._oPlayer.getX(),400,TEXT_BOOST,s_oStage)}};
CGame.prototype.checkCoinCollision=function(a,b){!this._bGameOver&&this._oPlayer.getRect().intersects(a)&&(b.collect(),this.refreshScore(COLLECT_SCORE*(1<this._oAcceleration.value?BOOST_SCORE_MULTIPLIER:1)),this._checkIncreaseDifficulty())};
CGame.prototype._checkIncreaseDifficulty=function(){this._iCurDifficulty!=MODE_HARD&&(this._iCurDifficulty==MODE_EASY?this._iCurScore>=SCORE_NEEDED_FOR_EASY_MEDIUM&&(this._iCurDifficulty=MODE_EASY_MEDIUM):this._iCurDifficulty==MODE_EASY_MEDIUM?this._iCurScore>=SCORE_NEEDED_FOR_MEDIUM&&(this._iCurDifficulty=MODE_MEDIUM):this._iCurDifficulty==MODE_MEDIUM?this._iCurScore>=SCORE_NEEDED_FOR_MEDIUM_HARD&&(this._iCurDifficulty=MODE_MEDIUM_HARD):this._iCurDifficulty==MODE_MEDIUM_HARD&&this._iCurScore>=SCORE_NEEDED_FOR_HARD&&
(this._iCurDifficulty=MODE_HARD))};
CGame.prototype.checkCollision=function(a,b){if(!this._bGameOver&&!this._bPlayerInvulnerable){var c=this._oPlayer.getRect();if(c.intersects(a)){this._bGameOver=!0;this._bStartRace=!1;this._iCurTrembleIndex=0;var e=this;this._iIdInterval=setInterval(function(){e.tremble()},20);this._oPlayer.changeAnim(PLAYER_ANIM_FALL);b.playAnim(a.x>c.x?"left":"right");this._stopBoostEffect()}else{var k=Math.abs(a.x-c.x);k<DIST_X_FOR_GATE_ANIM&&b.playAnim(a.x>c.x?"left":"right");k=Math.abs(k)}this._oContainerElements.swapChildren(b.getContainer(),
this._oPlayer.getContainer())}};CGame.prototype.setSpeed=function(a){this._iBoostSpeedMultiplier=a;this._oField.setSpeed(a);for(var b=0;b<this._aGate.length;b++)this._aGate[b]&&this._aGate[b].setSpeed(a);for(b=0;b<this._aElements.length;b++)this._aElements[b]&&this._aElements[b].setSpeed(a)};CGame.prototype._stopBoostEffect=function(){this._oAcceleration&&createjs.Tween.removeTweens(this._oAcceleration);this.setSpeed(1);this._oPlayer.disableBoostAnim(50);stopSfxSound("boost")};
CGame.prototype._stopElementsUpdate=function(){for(var a=0;a<this._aGate.length;a++)this._aGate[a]&&this._aGate[a].stopUpdate();for(a=0;a<this._aElements.length;a++)this._aElements[a]&&this._aElements[a].stopUpdate()};
CGame.prototype._updateElements=function(){this._manageElementsDepth();for(var a=0;a<this._aGate.length;a++)this._aGate[a].canBeRemoved()?(this._aGate[a].unload(),this._aGate.splice(a,1),a--):this._aGate[a].update();for(a=0;a<this._aElements.length;a++)this._aElements[a].canBeRemoved()?(this._aElements[a].unload(),this._aElements.splice(a,1),a--):this._aElements[a].update()};
CGame.prototype._getNewPattern=function(){this._iCurPatternIndex=0;if(this._iCurDifficulty===MODE_EASY_MEDIUM)if(0==Math.floor(2*Math.random())){var a=Math.floor(Math.random()*PATTERN[MODE_EASY].length);this._oCurPattern=PATTERN[MODE_EASY][a].slice()}else a=Math.floor(Math.random()*PATTERN[MODE_MEDIUM].length),this._oCurPattern=PATTERN[MODE_MEDIUM][a].slice();else this._iCurDifficulty===MODE_MEDIUM_HARD?0==Math.floor(2*Math.random())?(a=Math.floor(Math.random()*PATTERN[MODE_MEDIUM].length),this._oCurPattern=
PATTERN[MODE_MEDIUM][a].slice()):(a=Math.floor(Math.random()*PATTERN[MODE_HARD].length),this._oCurPattern=PATTERN[MODE_HARD][a].slice()):(a=Math.floor(Math.random()*PATTERN[this._iCurDifficulty].length),this._oCurPattern=PATTERN[this._iCurDifficulty][a].slice());Math.floor(100*Math.random())<=SPAWN_POWER_UP_PERC&&this._oCurPattern.splice(0,0,.5<Math.random()?{final_x:Math.floor(Math.random()*(CANVAS_WIDTH/2+1400-(CANVAS_WIDTH/2-1400))+CANVAS_WIDTH/2-1400),time_next:1E3,element_type:ELEMENT_BOOSTER}:
{final_x:Math.floor(Math.random()*(CANVAS_WIDTH/2+1400-(CANVAS_WIDTH/2-1400))+CANVAS_WIDTH/2-1400),time_next:1E3,element_type:ELEMENT_INVULNERABILITY})};
CGame.prototype._spawnElements=function(){if(!this._bGameOver&&this._bStartEnemySpawn)if(this._iTimeElapsSpawn+=s_iTimeElaps*this._iBoostSpeedMultiplier,this._iCurPatternIndex<this._oCurPattern.length){if(this._iTimeElapsSpawn>=this._iSpawnTime){this._iTimeElapsSpawn=0;do this._iSpawnTime=this._oCurPattern[this._iCurPatternIndex].time_next,this._oCurPattern[this._iCurPatternIndex].element_type==ELEMENT_ENEMY?this._spawnEnemy(this._oCurPattern[this._iCurPatternIndex].final_x):this._oCurPattern[this._iCurPatternIndex].element_type==
ELEMENT_BOOSTER?this._spawnBooster(this._oCurPattern[this._iCurPatternIndex].final_x):this._oCurPattern[this._iCurPatternIndex].element_type==ELEMENT_COIN?this._spawnCoin(this._oCurPattern[this._iCurPatternIndex].final_x):this._oCurPattern[this._iCurPatternIndex].element_type==ELEMENT_INVULNERABILITY&&this._spawnInvulnerability(this._oCurPattern[this._iCurPatternIndex].final_x),this._iCurPatternIndex++;while(0==this._iSpawnTime)}}else this._getNewPattern()};
function CInterface(a){var b,c,e,k,p,n,m,d,g,w,h,u,v,q,x,r,y,f,t,G,A,z,E,B,P,L,M=null,Q=null,S,aa,X,V,W,U,l;this._init=function(Y){if(s_bMobile){var F=s_oSpriteLibrary.getSprite("but_left");p=F.width/2+150;n=CANVAS_HEIGHT-F.height/2-50;P=createBitmap(F);P.regX=F.width/2;P.regY=F.height/2;P.x=p;P.y=n;s_oStage.addChild(P);F=s_oSpriteLibrary.getSprite("but_right");e=CANVAS_WIDTH-F.width/2-150;k=CANVAS_HEIGHT-F.height/2-50;L=createBitmap(F);L.regX=F.width/2;L.regY=F.height/2;L.x=e;L.y=k;s_oStage.addChild(L);
U=new createjs.Shape;U.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(10,0,CANVAS_WIDTH/2-10,CANVAS_HEIGHT);s_oStage.addChild(U);_oHitAreaLeftListenerDown=U.on("mousedown",this._onLeftDown);l=U.on("pressup",this._onLeftUp);V=new createjs.Shape;V.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(CANVAS_WIDTH/2+10,0,CANVAS_WIDTH/2-10,CANVAS_HEIGHT);s_oStage.addChild(V);W=V.on("mousedown",this._onRightDown);_oHitAreaRightListenerUp=V.on("pressup",this._onRightUp)}else document.onkeydown=this.onKeyDown,
document.onkeyup=this.onKeyUp;f=new createjs.Container;f.visible=!1;s_oStage.addChild(f);F=new createjs.Shape;F.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);F.alpha=.5;f.addChild(F);F=new createjs.Text(TEXT_PAUSE,"120px "+FONT_GAME,"#fff");F.textAlign="center";F.textBaseline="alphabetic";F.x=CANVAS_WIDTH/2;F.y=CANVAS_HEIGHT/2;f.addChild(F);F=s_oSpriteLibrary.getSprite("but_settings");var N=CANVAS_WIDTH,H=F.height/2+10;S=new CGUIExpandible(N,H,F,s_oStage);F=s_oSpriteLibrary.getSprite("but_exit");
h=N;u=H+F.height+10;G=new CSideGfxButton(!1,h-s_iOffsetX,u,F,s_oStage);G.addEventListener(ON_MOUSE_UP,this._onExit,this);F=s_oSpriteLibrary.getSprite("but_pause");b=CANVAS_WIDTH;c=u+F.height+10;B=new CSideGfxButton(!1,b-s_iOffsetX,c,F,s_oStage);B.addEventListener(ON_MOUSE_UP,this._onPause,this);N=100;!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(F=s_oSpriteLibrary.getSprite("audio_icon"),x=CANVAS_WIDTH,r=c+F.height+10,A=new CSideToggle(!1,N,x-s_iOffsetX,r,F,s_bAudioActive,s_oStage),A.addEventListener(ON_MOUSE_UP,
this._onAudioToggle,this),N+=100,v=CANVAS_WIDTH,q=r+F.height+10,z=new CSideToggle(!1,N,v-s_iOffsetX,q,s_oSpriteLibrary.getSprite("music_icon"),s_bMusicActive,s_oStage),z.addEventListener(ON_MOUSE_UP,this._onMusicToggle,this),m=CANVAS_WIDTH,d=q+F.height+10,N+=100):(m=CANVAS_WIDTH,d=c+F.height+10);F=window.document;H=F.documentElement;M=H.requestFullscreen||H.mozRequestFullScreen||H.webkitRequestFullScreen||H.msRequestFullscreen;Q=F.exitFullscreen||F.mozCancelFullScreen||F.webkitExitFullscreen||F.msExitFullscreen;
!1===ENABLE_FULLSCREEN&&(M=!1);M&&screenfull.isEnabled&&(F=s_oSpriteLibrary.getSprite("but_fullscreen"),E=new CSideToggle(!1,N,m-s_iOffsetX,d+s_iOffsetY,F,s_bFullscreen,s_oStage),E.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));S.addButton(G);S.addButton(B);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)S.addButton(A),S.addButton(z);M&&screenfull.isEnabled&&S.addButton(E);F=s_oSpriteLibrary.getSprite("score_panel");g=0;w=10;X=new createjs.Container;X.x=g;X.y=w;s_oStage.addChild(X);N=
createBitmap(F);X.addChild(N);t=new CTLText(X,F.width/3,F.height/2-20+10,F.width/2,40,30,"left","#fff",FONT_GAME,1,0,0,Y,!0,!0,!1,!1);aa=new CAreYouSurePanel;aa.addEventListener(ON_BUT_YES_DOWN,this._onExitYes,this);y=new CRollingScore;this.refreshButtonPos()};this.unload=function(){G.unload();G=null;S.unload();aa.unload();!1===DISABLE_SOUND_MOBILE&&(A.unload(),A=null,z.unload());M&&screenfull.isEnabled&&E.unload();s_bMobile?(U.off("mousedown",_oHitAreaLeftListenerDown),U.off("pressup",l),V.off("mousedown",
W),V.off("pressup",_oHitAreaRightListenerUp)):(document.onkeydown=null,document.onkeyup=null);s_oStage.removeAllChildren();s_oInterface=null};this.reset=function(Y){t.refreshText(Y)};this.refreshButtonPos=function(){X.x=g+s_iOffsetX;X.y=w+s_iOffsetY;S.refreshPos();if(S.isExpanded()){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)A.setPosition(x-s_iOffsetX,s_iOffsetY+r),z.setPosition(v-s_iOffsetX,s_iOffsetY+q);M&&screenfull.isEnabled&&E.setPosition(m-s_iOffsetX,d+s_iOffsetY);G.setPosition(h-s_iOffsetX,
u+s_iOffsetY);B.setPosition(b-s_iOffsetX,c+s_iOffsetY)}else{if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)A.setY(s_iOffsetY+r),z.setY(s_iOffsetY+q);M&&screenfull.isEnabled&&E.setY(d+s_iOffsetY);G.setY(u+s_iOffsetY);B.setY(c+s_iOffsetY);G.resetX();B.resetX()}s_bMobile&&(P.x=p+s_iOffsetX,P.y=n-s_iOffsetY,L.x=e-s_iOffsetX,L.y=k-s_iOffsetY)};this.refreshScore=function(Y){y.rolling(t.getText(),null,Y)};this._onLeftDown=function(){s_oGame.mobileMoveKeyDown(!0)};this._onRightDown=function(){s_oGame.mobileMoveKeyDown(!1)};
this._onLeftUp=function(){s_oGame.mobileMoveKeyUp(!0)};this._onRightUp=function(){s_oGame.mobileMoveKeyUp(!1)};this._onExit=function(){aa.show(TEXT_ARE_SURE)};this._onAudioToggle=function(){muteAllSfx(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onMusicToggle=function(){muteAllMusic(s_bMusicActive);s_bMusicActive=!s_bMusicActive};this._onPause=function(){if(s_oMain.isUpdating()){f.visible=!0;S.disable();G.disable();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)A.disable(),z.disable();M&&screenfull.isEnabled&&
E.disable();muteAllSfx(!0);s_oStage.update();s_oMain.stopUpdateNoBlock();s_bGamePaused=!0}else{s_oMain.startUpdateNoBlock();S.enable();G.enable();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)A.enable(),z.enable();M&&screenfull.isEnabled&&E.enable();muteAllSfx(!s_bAudioActive);s_bGamePaused=f.visible=!1}};this.resetFullscreenBut=function(){M&&screenfull.isEnabled&&E.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?Q.call(window.document):M.call(window.document.documentElement);
sizeHandler()};this._onExitYes=function(){s_oGame.onExit()};this.onKeyDown=function(){s_oGame.onKeyDown()};this.onKeyUp=function(){s_oGame.onKeyUp()};s_oInterface=this;this._init(a);return this}var s_oInterface=null;
function CHelpPanel(){var a,b,c,e,k,p,n,m,d,g,w,h,u,v,q,x,r=this;this._init=function(){h=new createjs.Container;h.visible=!1;s_oStage.addChild(h);e=new createjs.Shape;e.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);c=e.on("click",function(){});h.addChild(e);var y=s_oSpriteLibrary.getSprite("msg_box_help"),f=createBitmap(y);f.regX=y.width/2;f.regY=y.height/2;f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2;h.addChild(f);f=[];y=s_oSpriteLibrary.getSprite("help_santa");for(var t=
0;44>=t;t++)f.push(s_oSpriteLibrary.getSprite("help_santa_"+t));t=f[0].width;var G=f[0].height;f=new createjs.SpriteSheet({images:f,framerate:15,frames:{width:t,height:G,regX:t/2},animations:{start:0,anim:[0,f.length-1]}});n=createSprite(f,"start",t/2,0,t,G);n.x=CANVAS_WIDTH/2-230;n.y=140;h.addChild(n);b=[];s_bMobile?(f=s_oSpriteLibrary.getSprite("but_left"),t=s_oSpriteLibrary.getSprite("but_right"),G=TEXT_HELP1_MOBILE):(f=s_oSpriteLibrary.getSprite("key_0"),t=s_oSpriteLibrary.getSprite("key_1"),
G=TEXT_HELP1_DESKTOP);u=new CTLText(h,320,380,400,120,34,"center","#fff",FONT_GAME,1,0,0,G,!0,!1,!0,!1);v=new CTLText(h,780,380,400,120,34,"center","#fff",FONT_GAME,1,0,0,TEXT_HELP2,!0,!1,!0,!1);k=createBitmap(f);k.regX=f.width/2;k.regY=f.height/2;k.x=CANVAS_WIDTH/2-370;k.y=CANVAS_HEIGHT/2-60;h.addChild(k);b.push(k);p=createBitmap(t);p.regX=t.width/2;p.regY=t.height/2;p.x=CANVAS_WIDTH/2-90;p.y=CANVAS_HEIGHT/2-60;h.addChild(p);b.push(p);s_bMobile&&(k.scale=.5,p.scale=.5);m=createBitmap(y);m.x=CANVAS_WIDTH/
2+230;m.y=140;m.regX=y.width/2;h.addChild(m);y=s_oSpriteLibrary.getSprite("booster_icon");q=createBitmap(y);q.x=300;q.y=150;q.visible=!1;h.addChild(q);_oBoosterHelp=new CTLText(h,450,q.y,750,y.height,40,"left","#fff",FONT_GAME,1,0,0,TEXT_HELP_BOOSTER,!0,!0,!0,!1);_oBoosterHelp.setVisible(!1);y=s_oSpriteLibrary.getSprite("star_icon");x=createBitmap(y);x.x=300;x.y=350;x.visible=!1;h.addChild(x);_oInvulnerabilityHelp=new CTLText(h,450,x.y,750,y.height,40,"left","#fff",FONT_GAME,1,0,0,sprintf(TEXT_HELP_INVULNERABILITY,
(INVULNERABILITY_DURATION_TIME/1E3).toString()),!0,!0,!0,!1);_oInvulnerabilityHelp.setVisible(!1);d=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT-180,s_oSpriteLibrary.getSprite("but_continue"),h);d.setScale(.6);d.addEventListener(ON_MOUSE_UP,this._onStart,this);g=new CGfxButton(CANVAS_WIDTH-235,CANVAS_HEIGHT/2,s_oSpriteLibrary.getSprite("but_next"),h);g.addEventListener(ON_MOUSE_UP,this._onNext,this);w=new CGfxButton(235,CANVAS_HEIGHT/2,s_oSpriteLibrary.getSprite("but_prev"),h);w.setVisible(!1);w.addEventListener(ON_MOUSE_UP,
this._onPrev,this)};this.unload=function(){e.off("click",c);d.unload();g.unload();w.unload()};this.show=function(){a=0;p.scale=s_bMobile?.4:.9;n.gotoAndPlay("anim");h.alpha=0;h.visible=!0;createjs.Tween.get(h).to({alpha:1},500)};this.hide=function(){createjs.Tween.get(h).to({alpha:0},500,createjs.Ease.cubicOut).call(function(){h.visible=!1;r.unload()})};this._attachPlayer=function(y,f,t,G){t=[];for(var A=0;18>A;A++)t.push(s_oSpriteLibrary.getSprite("player_running_"+A));A=t[0].width;var z=t[0].height;
t=new createjs.SpriteSheet({images:t,frames:{width:A,height:z,regX:A/2,regY:z},animations:{start:0,anim:[0,t.length-1,G]}});t=createSprite(t,"start",A/2,z,A,z);t.scaleX=t.scaleY=.7;t.x=y;t.y=f;h.addChild(t);return t};this._toggleKeyAnims=function(){s_bMobile?.4===p.scale?(p.scale=.5,k.scale=.4):(k.scale=.5,p.scale=.4):.9===p.scale?(p.scale=1,k.scale=.9):(k.scale=1,p.scale=.9)};this._onStart=function(){d.disable();r.hide();s_oGame.onExitFromHelp()};this._onNext=function(){g.setVisible(!1);w.setVisible(!0);
b.forEach(function(y){y.visible=!1});u.setVisible(!1);v.setVisible(!1);n.visible=!1;m.visible=!1;x.visible=!0;_oInvulnerabilityHelp.setVisible(!0);q.visible=!0;_oBoosterHelp.setVisible(!0)};this._onPrev=function(){g.setVisible(!0);w.setVisible(!1);b.forEach(function(y){y.visible=!0});u.setVisible(!0);v.setVisible(!0);n.visible=!0;m.visible=!0;x.visible=!1;_oInvulnerabilityHelp.setVisible(!1);q.visible=!1;_oBoosterHelp.setVisible(!1)};this.isVisible=function(){return h.visible};this.update=function(){a+=
s_iTimeElaps;1500<a&&(a=0,this._toggleKeyAnims())};this._init()}
function CCreditsPanel(){var a,b,c,e,k,p,n;this._init=function(){n=new createjs.Container;s_oStage.addChild(n);var m=new createjs.Shape;m.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n.addChild(m);m=s_oSpriteLibrary.getSprite("msg_box_small");a=createBitmap(m);a.regX=m.width/2;a.regY=m.height/2;a.x=CANVAS_WIDTH/2;a.y=CANVAS_HEIGHT/2;n.addChild(a);k=new createjs.Shape;k.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);k.alpha=.01;k.on("click",
this._onLogoButRelease);n.addChild(k);m=s_oSpriteLibrary.getSprite("but_no");c=new CGfxButton(920,286,m,n);c.setScale(.6);c.addEventListener(ON_MOUSE_UP,this.unload,this);e=new createjs.Text(TEXT_CREDITS_DEVELOPED,"26px "+FONT_GAME,"#fff");e.textAlign="center";e.textBaseline="alphabetic";e.x=CANVAS_WIDTH/2;e.y=330;n.addChild(e);m=s_oSpriteLibrary.getSprite("logo_ctl");b=createBitmap(m);b.regX=m.width/2;b.regY=m.height/2;b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2;n.addChild(b);p=new createjs.Text("www.codethislab.com",
"26px "+FONT_GAME,"#fff");p.textAlign="center";p.textBaseline="alphabetic";p.x=CANVAS_WIDTH/2;p.y=450;n.addChild(p)};this.unload=function(){k.off("click",this._onLogoButRelease);c.unload();c=null;s_oStage.removeChild(n)};this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en","_blank")};this._init()}
function CAlertSavingBox(a,b){var c,e;this._init=function(n){e=new createjs.Container;p.addChild(e);var m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);m.alpha=.5;m.on("click",function(){});e.addChild(m);m=s_oSpriteLibrary.getSprite("msg_box_wide");var d=createBitmap(m);d.x=.5*CANVAS_WIDTH;d.y=.5*CANVAS_HEIGHT;d.regX=.5*m.width;d.regY=.5*m.height;e.addChild(d);new CTLText(e,CANVAS_WIDTH/2-350,275,700,300,38,"center","#fff",FONT_GAME,1,0,0,n,!0,!0,!0,!1);
c=new CGfxButton(1075,195,s_oSpriteLibrary.getSprite("but_no"),e);c.addEventListener(ON_MOUSE_UP,this._onButOk,this)};this._onButOk=function(){k.unload()};this.unload=function(){c.unload();p.removeChild(e)};var k=this;var p=b;this._init(a)}
function CAreYouSurePanel(){var a,b,c,e,k,p,n,m,d=this;this._init=function(){a=[];b=[];n=new createjs.Container;n.visible=!1;s_oStage.addChild(n);m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);m.alpha=.5;m.on("click",function(){});n.addChild(m);var g=s_oSpriteLibrary.getSprite("msg_box_small");c=createBitmap(g);c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT/2;c.regX=.5*g.width;c.regY=.5*g.height;n.addChild(c);e=new CTLText(n,CANVAS_WIDTH/2-200,CANVAS_HEIGHT/2-130,
400,120,60,"center","#fff",FONT_GAME,1,0,0,TEXT_ARE_SURE,!0,!0,!0,!1);k=new CGfxButton(CANVAS_WIDTH/2+140,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_yes"),n);k.addEventListener(ON_MOUSE_UP,this._onButYes,this);p=new CGfxButton(CANVAS_WIDTH/2-140,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_no"),n);p.addEventListener(ON_MOUSE_UP,this._onButNo,this)};this.addEventListener=function(g,w,h){a[g]=w;b[g]=h};this.show=function(g){e.refreshText(g);n.alpha=0;n.visible=!0;createjs.Tween.get(n).to({alpha:1},
100,createjs.Ease.quartOut).call(function(){s_oMain.stopUpdateNoBlock()})};this.hide=function(){s_oMain.startUpdateNoBlock();createjs.Tween.get(n).to({alpha:0},100,createjs.Ease.quartOut).call(function(){n.visible=!1})};this.unload=function(){p.unload();k.unload()};this._onButYes=function(){d.hide();a[ON_BUT_YES_DOWN]&&a[ON_BUT_YES_DOWN].call(b[ON_BUT_YES_DOWN])};this._onButNo=function(){d.hide()};this._init()}
function CGUIExpandible(a,b,c,e){var k,p,n,m,d;this._init=function(w,h,u,v){p=[];m=new createjs.Container;m.x=w;m.y=h;v.addChild(m);d=new createjs.Container;m.addChild(d);k=!1;n=new CSideGfxButton(!1,0,0,u,d);n.addEventListener(ON_MOUSE_UP,this._onMenu,this);n.tweenFinalX()};this.unload=function(){n.unload();e.removeChild(m)};this.refreshPos=function(){m.x=a-s_iOffsetX;m.y=b+s_iOffsetY;for(var w=0;w<p.length;w++)p[w].setFinalX(m.x)};this.addButton=function(w){p.push(w)};this._onMenu=function(){(k=
!k)?g._expand():g._collapse()};this._expand=function(){for(var w=0;w<p.length;w++)p[w].tweenFinalX()};this._collapse=function(){for(var w=100*p.length,h=0;h<p.length;h++)p[h].tweenStartX(w),w-=100};this.isExpanded=function(){return k};this.disable=function(){n.disable()};this.enable=function(){n.enable()};var g=this;this._init(a,b,c,e)}
function CField(a,b,c){var e,k,p,n,m,d,g,w,h;this._init=function(v,q){w=20;h=1;d=new createjs.Container;d.x=v;d.y=q;u.addChild(d);for(var x=[],r=0;29>=r;r++){var y=s_oSpriteLibrary.getSprite("field_loop_"+r);x.push(y)}x=new createjs.SpriteSheet({images:x,framerate:w,frames:{width:1600,height:y.height},animations:{start:0,anim:[0,29,"anim"]}});g=createSprite(x,"start",0,0,1600,y.height);d.addChild(g);n=[];m=[];for(y=0;1>y;y++)x=new CSponsor(510,345,!0,d,h),n.push(x),x=new CSponsor(1070,345,!1,d,h),
m.push(x)};this.reset=function(){for(var v=0;v<n.length;v++)n[v].reset(),m[v].reset();g.framerate=w;e=!1;p=k=0};this.show=function(){g.gotoAndPlay("anim");e=!0};this.hide=function(){g.gotoAndStop("start");d.visible=!1};this.addEventListener=function(v,q,x){};this.stopAnim=function(){g.stop();this.stopSponsors()};this.prepareSponsorsForStop=function(){for(var v=0;v<n.length;v++)n[v].readyForRemoval(),m[v].readyForRemoval()};this.stopSponsors=function(){for(var v=0;v<n.length;v++)n[v].stopTween(),m[v].stopTween()};
this.setSpeed=function(v){h=v;g.framerate=w*v;for(v=0;v<n.length;v++)n[v].setSpeed(h);for(v=0;v<m.length;v++)m[v].setSpeed(h)};this.update=function(){e&&(k+=s_iTimeElaps,2E3<k&&(k=0,n[p].startAnim(h),m[p].startAnim(h),p++,p===n.length&&(e=!1)))};var u=c;this._init(a,b)}
var CPlayerBase=function(a,b,c){this._bUpdate;this._bLeft;this._bRight;this._iCurAnim;this._iTotAnimFrame;this._iCurFrameIndex;this._iStartX;this._iStartY;this._iCurAcceleration;this._iCurMaxSpeed;this._iXMove;this._iWidthSprite;this._iHeightSprite;this._aAnim;this._aAnimNumFrames;this._aCbCompleted;this._aCbOwner;this._oContainer;this._oParentContainer;this._oShapeRect;this._oStandardContainer};
CPlayerBase.prototype._init=function(a,b,c){this._oParentContainer=c;this._iStartX=a;this._iStartY=b;this._iXMove=0;this._iCurAcceleration=HERO_ACCELERATION;this._iCurMaxSpeed=MAX_HERO_SPEED;this._aCbCompleted=[];this._aCbOwner=[];this._bRight=this._bLeft=this._bUpdate=!1;this._oContainer=new createjs.Container;this._oContainer.x=a;this._oContainer.y=b;this._oParentContainer.addChild(this._oContainer);this._oStandardContainer=new createjs.Container;this._oStandardContainer.visible=!0;this._oContainer.addChild(this._oStandardContainer);
this._aAnimNumFrames=[];this._aAnimNumFrames[PLAYER_ANIM_RUN]=19;this._aAnimNumFrames[PLAYER_ANIM_FALL]=30;this._aAnimNumFrames[PLAYER_ANIM_LEFT]=8;this._aAnimNumFrames[PLAYER_ANIM_RIGHT]=8;this._aAnimNumFrames[PLAYER_ANIM_LEFT_OUT]=7;this._aAnimNumFrames[PLAYER_ANIM_RIGHT_OUT]=7;this._aAnim=[];this._aAnim[PLAYER_ANIM_RUN]=[];for(a=0;a<this._aAnimNumFrames[PLAYER_ANIM_RUN];a++)b=s_oSpriteLibrary.getSprite(s_szPlayerType+"_running_"+a),c=createBitmap(b),c.visible=!1,c.regX=b.width/2,c.regY=b.height,
this._oStandardContainer.addChild(c),this._aAnim[PLAYER_ANIM_RUN].push(c);this._aAnim[PLAYER_ANIM_FALL]=[];for(a=0;a<this._aAnimNumFrames[PLAYER_ANIM_FALL];a++)b=s_oSpriteLibrary.getSprite(s_szPlayerType+"_falling_"+a),c=createBitmap(b),c.visible=!1,c.regX=b.width/2,c.regY=b.height,this._oStandardContainer.addChild(c),this._aAnim[PLAYER_ANIM_FALL].push(c);this._aAnim[PLAYER_ANIM_LEFT]=[];for(a=0;a<this._aAnimNumFrames[PLAYER_ANIM_LEFT];a++)b=s_oSpriteLibrary.getSprite(s_szPlayerType+"_left_"+a),c=
createBitmap(b),c.visible=!1,c.regX=b.width/2,c.regY=b.height,this._oStandardContainer.addChild(c),this._aAnim[PLAYER_ANIM_LEFT].push(c);this._aAnim[PLAYER_ANIM_RIGHT]=[];for(a=0;a<this._aAnimNumFrames[PLAYER_ANIM_RIGHT];a++)b=s_oSpriteLibrary.getSprite(s_szPlayerType+"_right_"+a),c=createBitmap(b),c.visible=!1,c.regX=b.width/2,c.regY=b.height,this._oStandardContainer.addChild(c),this._aAnim[PLAYER_ANIM_RIGHT].push(c);this._aAnim[PLAYER_ANIM_LEFT_OUT]=[];for(a=0;a<this._aAnimNumFrames[PLAYER_ANIM_LEFT_OUT];a++)b=
s_oSpriteLibrary.getSprite(s_szPlayerType+"_left_out_"+a),c=createBitmap(b),c.visible=!1,c.regX=b.width/2,c.regY=b.height,this._oStandardContainer.addChild(c),this._aAnim[PLAYER_ANIM_LEFT_OUT].push(c);this._aAnim[PLAYER_ANIM_RIGHT_OUT]=[];for(a=0;a<this._aAnimNumFrames[PLAYER_ANIM_RIGHT_OUT];a++)b=s_oSpriteLibrary.getSprite(s_szPlayerType+"_right_out_"+a),c=createBitmap(b),c.visible=!1,c.regX=b.width/2,c.regY=b.height,this._oStandardContainer.addChild(c),this._aAnim[PLAYER_ANIM_RIGHT_OUT].push(c);
this._iCurAnim=PLAYER_ANIM_RUN};CPlayerBase.prototype.addEventListener=function(a,b,c){this._aCbCompleted[a]=b;this._aCbOwner[a]=c};CPlayerBase.prototype.show=function(){this._iTotAnimFrame=this._aAnimNumFrames[this._iCurAnim];this._aAnim[this._iCurAnim][0].visible=!0;this._iCurFrameIndex=0;this._oContainer.visible=!0;this._iWidthSprite=this._oContainer.getBounds().width-450;this._iHeightSprite=this._oContainer.getBounds().height-200;playSfxSound("skiing",1,!0);this._bUpdate=!0};
CPlayerBase.prototype.hide=function(){this._bUpdate=!1;this._oContainer.visible=!1};
CPlayerBase.prototype.reset=function(){this._bUpdate=!1;createjs.Tween.removeTweens(this._oContainer);this._bRight=this._bLeft=!1;this._iXMove=0;this._iCurAcceleration=HERO_ACCELERATION;this._iCurMaxSpeed=MAX_HERO_SPEED;this._oContainer.alpha=1;this._oContainer.x=this._iStartX;this._oContainer.y=this._iStartY;for(var a=0;a<this._aAnimNumFrames[PLAYER_ANIM_RUN];a++)this._aAnim[PLAYER_ANIM_RUN][a].visible=!1;for(a=0;a<this._aAnimNumFrames[PLAYER_ANIM_FALL];a++)this._aAnim[PLAYER_ANIM_FALL][a].visible=
!1;for(a=0;a<this._aAnimNumFrames[PLAYER_ANIM_LEFT];a++)this._aAnim[PLAYER_ANIM_LEFT][a].visible=!1;for(a=0;a<this._aAnimNumFrames[PLAYER_ANIM_RIGHT];a++)this._aAnim[PLAYER_ANIM_RIGHT][a].visible=!1;this._iCurAnim=PLAYER_ANIM_RUN;this._resetFX()};
CPlayerBase.prototype.changeAnim=function(a){a!==this._iCurAnim&&(this._bUpdate=!1,this._aAnim[this._iCurAnim][this._iCurFrameIndex].visible=!1,this._checkFX(!1),this._iCurAnim=a,this._aAnim[this._iCurAnim][0].visible=!0,this._iCurFrameIndex=0,this._checkFX(!0),this._iTotAnimFrame=this._aAnimNumFrames[this._iCurAnim],this._bUpdate=!0,a===PLAYER_ANIM_LEFT||a===PLAYER_ANIM_RIGHT?playSfxSound("skiing_direction",1,!1):a===PLAYER_ANIM_FALL&&(stopSfxSound("skiing"),playSfxSound("falling",1,!1)))};
CPlayerBase.prototype.playToFrame=function(a){this._aAnim[this._iCurAnim][this._iCurFrameIndex].visible=!1;this._checkFX(!1);this._iCurFrameIndex=a;this._aAnim[this._iCurAnim][this._iCurFrameIndex].visible=!0;this._checkFX(!0)};CPlayerBase.prototype.nextFrame=function(){this._aAnim[this._iCurAnim][this._iCurFrameIndex].visible=!1;this._checkFX(!1);this._iCurFrameIndex++;this._aAnim[this._iCurAnim][this._iCurFrameIndex].visible=!0;this._checkFX(!0)};
CPlayerBase.prototype.moveLeft=function(a){this._oContainer.x===MIN_PLAYER_X?(this._bLeft=!1,this._iXMove=0):(a?this.changeAnim(PLAYER_ANIM_LEFT):this.changeAnim(PLAYER_ANIM_LEFT_OUT),this._bLeft=a)};CPlayerBase.prototype.moveRight=function(a){this._oContainer.x===MAX_PLAYER_X?(this._bRight=!1,this._iXMove=0):(a?this.changeAnim(PLAYER_ANIM_RIGHT):this.changeAnim(PLAYER_ANIM_RIGHT_OUT),this._bRight=a)};CPlayerBase.prototype.resetMovGates=function(){this._bRight=this._bLeft=!1};
CPlayerBase.prototype.setAcceleration=function(a,b){this._iCurAcceleration=a;this._iCurMaxSpeed=b};CPlayerBase.prototype.stopAnim=function(){this._bUpdate=!1};CPlayerBase.prototype.setY=function(a){this._oContainer.y=a};
CPlayerBase.prototype.getRect=function(){var a=-this._iWidthSprite/2;switch(this._iCurAnim){case PLAYER_ANIM_LEFT:a+=-5*this._iCurFrameIndex;break;case PLAYER_ANIM_LEFT_OUT:a+=-5*(6-this._iCurFrameIndex);break;case PLAYER_ANIM_RIGHT:a+=5*this._iCurFrameIndex;break;case PLAYER_ANIM_RIGHT_OUT:a+=5*(6-this._iCurFrameIndex);break;default:a+=-(this._oContainer.x-CANVAS_WIDTH/2)/50*3}return new createjs.Rectangle(this._oContainer.x+a,this._oContainer.y-this._iHeightSprite,this._iWidthSprite,this._iHeightSprite)};
CPlayerBase.prototype.getCurAnim=function(){return this._iCurAnim};CPlayerBase.prototype.getX=function(){return this._oContainer.x};CPlayerBase.prototype.getY=function(){return this._oContainer.y};CPlayerBase.prototype.getContainer=function(){return this._oContainer};
CPlayerBase.prototype._updateMove=function(){if(this._iCurAnim!==PLAYER_ANIM_FALL){this._bLeft&&(this._iXMove-=this._iCurAcceleration);this._bRight&&(this._iXMove+=this._iCurAcceleration);this._oContainer.x+=this._iXMove;this._iXMove*=HERO_FRICTION;this._iXMove>this._iCurMaxSpeed&&(this._iXMove=this._iCurMaxSpeed);this._iXMove<-this._iCurMaxSpeed&&(this._iXMove=-this._iCurMaxSpeed);.1>Math.abs(this._iXMove)&&(this._iXMove=0);this._oContainer.x+this._iXMove>=MAX_PLAYER_X?(this._oContainer.x=MAX_PLAYER_X,
this._iCurAnim===PLAYER_ANIM_RIGHT&&this.changeAnim(PLAYER_ANIM_RIGHT_OUT)):this._oContainer.x-this._iXMove<=MIN_PLAYER_X&&(this._oContainer.x=MIN_PLAYER_X,this._iCurAnim===PLAYER_ANIM_LEFT&&this.changeAnim(PLAYER_ANIM_LEFT_OUT));var a=50;a=this._oContainer.x>CANVAS_WIDTH/2?a*this.easeInQuart(this._oContainer.x-CANVAS_WIDTH/2,0,1,MAX_PLAYER_X-CANVAS_WIDTH/2):a*(1-this.easeOutQuart(this._oContainer.x-MIN_PLAYER_X,0,1,CANVAS_WIDTH/2-MIN_PLAYER_X));this._oContainer.y=this._iStartY-a;this._oContainer.setTransform(this._oContainer.x,
this._oContainer.y,1,1,0,-(this._oContainer.x-CANVAS_WIDTH/2)/50)}};CPlayerBase.prototype.easeInQuart=function(a,b,c,e){return c*(a/=e)*a*a*a+b};CPlayerBase.prototype.easeOutQuart=function(a,b,c,e){return-c*((a=a/e-1)*a*a*a-1)+b};CPlayerBase.prototype.easeInCubic=function(a,b,c,e){return c*(a/=e)*a*a+b};CPlayerBase.prototype.easeOutCubic=function(a,b,c,e){return c*((a=a/e-1)*a*a+1)+b};
CPlayerBase.prototype.update=function(){if(!1!==this._bUpdate){this._updateMove();if(this._iCurFrameIndex===this._iTotAnimFrame-1)switch(this._iCurAnim){case PLAYER_ANIM_RUN:this.playToFrame(0);break;case PLAYER_ANIM_FALL:this.hide();this._aCbCompleted[ON_PLAYER_FALL]&&this._aCbCompleted[ON_PLAYER_FALL].call(this._aCbOwner[ON_PLAYER_FALL],TEXT_GAME_OVER);break;case PLAYER_ANIM_LEFT_OUT:case PLAYER_ANIM_RIGHT_OUT:this.changeAnim(PLAYER_ANIM_RUN)}else this.nextFrame();this._checkLastFrameAnimation();
this.getRect();var a=FPS;15<Math.abs(this._iXMove)?a-=6:10<Math.abs(this._iXMove)?a-=4:5<Math.abs(this._iXMove)&&(a-=2);createjs.Ticker.framerate=a;return Math.abs(this._iXMove)}};var CPlayerSanta=function(a,b,c){CPlayerBase.call(this,a,b,c);this._bBoostActive;this._oBoostContainer;this._oHat;this._oBoostHat;this._oBoostAnim;this._init(a,b,c)};CPlayerSanta.prototype=Object.create(CPlayerBase.prototype);
CPlayerSanta.prototype._init=function(a,b,c){CPlayerBase.prototype._init(a,b,c);this._bBoostActive=!1;this._oBoostContainer=new createjs.Container;this._oBoostContainer.alpha=0;this._oContainer.addChild(this._oBoostContainer);this._setHat();this._setBoostParticle()};CPlayerSanta.prototype._resetFX=function(){this._bBoostActive=!1;this._oBoostContainer.alpha=0};
CPlayerSanta.prototype._setHat=function(){for(var a=[],b=0;19>b;b++)a.push(s_oSpriteLibrary.getSprite("santa_hat_"+b));b=a[0].width;var c=a[0].height;a={images:a,frames:{width:b,height:c,regX:b/2,regY:c/2},animations:{idle:[0,18,"idle"],stop:[0,0]}};a=new createjs.SpriteSheet(a);this._oHat=createSprite(a,"idle",b/2,c/2,b,c);this._oHat.x=-10;this._oHat.y=-388;this._oHat.visible=!1;this._oContainer.addChild(this._oHat);a=[];for(b=0;19>b;b++)a.push(s_oSpriteLibrary.getSprite("santa_boost_hat_"+b));b=
a[0].width;c=a[0].height;a={images:a,frames:{width:b,height:c,regX:b/2,regY:c/2},animations:{idle:[0,18,"idle"],stop:[0,0]}};a=new createjs.SpriteSheet(a);this._oBoostHat=createSprite(a,"idle",b/2,c/2,b,c);this._oBoostHat.x=-10;this._oBoostHat.y=-388;this._oBoostHat.visible=!1;this._oBoostContainer.addChild(this._oBoostHat)};
CPlayerSanta.prototype._setBoostParticle=function(){this._oBoostAnim=[];var a=s_szPlayerType+"boost";this._oBoostAnim[PLAYER_ANIM_RUN]=[];for(var b=0;b<this._aAnimNumFrames[PLAYER_ANIM_RUN];b++){var c=s_oSpriteLibrary.getSprite(a+"_running_"+b),e=createBitmap(c);e.visible=!1;e.regX=c.width/2;e.regY=c.height;this._oBoostContainer.addChild(e);this._oBoostAnim[PLAYER_ANIM_RUN].push(e)}this._oBoostAnim[PLAYER_ANIM_LEFT]=[];for(b=0;b<this._aAnimNumFrames[PLAYER_ANIM_LEFT];b++)c=s_oSpriteLibrary.getSprite(a+
"_left_"+b),e=createBitmap(c),e.visible=!1,e.regX=c.width/2,e.regY=c.height,this._oBoostContainer.addChild(e),this._oBoostAnim[PLAYER_ANIM_LEFT].push(e);this._oBoostAnim[PLAYER_ANIM_RIGHT]=[];for(b=0;b<this._aAnimNumFrames[PLAYER_ANIM_RIGHT];b++)c=s_oSpriteLibrary.getSprite(a+"_right_"+b),e=createBitmap(c),e.visible=!1,e.regX=c.width/2,e.regY=c.height,this._oBoostContainer.addChild(e),this._oBoostAnim[PLAYER_ANIM_RIGHT].push(e);this._oBoostAnim[PLAYER_ANIM_LEFT_OUT]=[];for(b=0;b<this._aAnimNumFrames[PLAYER_ANIM_LEFT_OUT];b++)c=
s_oSpriteLibrary.getSprite(a+"_left_out_"+b),e=createBitmap(c),e.visible=!1,e.regX=c.width/2,e.regY=c.height,this._oBoostContainer.addChild(e),this._oBoostAnim[PLAYER_ANIM_LEFT_OUT].push(e);this._oBoostAnim[PLAYER_ANIM_RIGHT_OUT]=[];for(b=0;b<this._aAnimNumFrames[PLAYER_ANIM_RIGHT_OUT];b++)c=s_oSpriteLibrary.getSprite(a+"_right_out_"+b),e=createBitmap(c),e.visible=!1,e.regX=c.width/2,e.regY=c.height,this._oBoostContainer.addChild(e),this._oBoostAnim[PLAYER_ANIM_RIGHT_OUT].push(e)};
CPlayerSanta.prototype._checkLastFrameAnimation=function(){this._animHat(this._oHat);this._animHat(this._oBoostHat)};CPlayerSanta.prototype._animHat=function(a){switch(this._iCurAnim){case PLAYER_ANIM_LEFT:7===this._iCurFrameIndex&&(a.x=-14,a.visible=!0,"idle"!==a.currentAnimation&&a.gotoAndPlay("idle"));break;case PLAYER_ANIM_RIGHT:7===this._iCurFrameIndex&&(a.visible=!0,"idle"!==a.currentAnimation&&a.gotoAndPlay("idle"));break;default:a.visible=!1,a.gotoAndPlay("stop")}};
CPlayerSanta.prototype._checkFX=function(a){this._iCurAnim===PLAYER_ANIM_FALL?this._oBoostContainer.alpha=0:this._oBoostAnim[this._iCurAnim][this._iCurFrameIndex].visible=a};CPlayerSanta.prototype.enableBoostAnim=function(a){var b=this;createjs.Tween.get(this._oBoostContainer).to({alpha:1},a).call(function(){b._bBoostActive=!0})};CPlayerSanta.prototype.disableBoostAnim=function(a){var b=this;createjs.Tween.get(this._oBoostContainer).to({alpha:0},a).call(function(){b._bBoostActive=!1})};
CPlayerSanta.prototype.enableInvulnerabilityAnim=function(){this._oContainer.alpha=.8;createjs.Tween.get(this._oContainer,{loop:-1,bounce:!0}).to({alpha:.3},300)};CPlayerSanta.prototype.disableInvulnerabilityAnim=function(){this._oContainer.alpha=1;createjs.Tween.removeTweens(this._oContainer)};
function CGate(a,b,c,e,k,p){var n,m,d=!1,g,w,h,u,v,q,x=this,r;x=this;var y,f,t,G;this._init=function(z,E,B){h=[];u=[];n=E;m=B;y=TIME_GATE_RUN;f=p||1;r=new createjs.Container;r.x=E;r.y=B;r.scaleX=r.scaleY=.05;A.addChild(r);g=165;w=366;q=z;r.addChild(q);new createjs.Rectangle(-g/2,-w,g,w);r.regX=271;r.regY=w;this.show()};this.addEventListener=function(z,E,B){h[z]=E;u[z]=B};this.reset=function(){r.x=n;r.y=m;r.scaleX=r.scaleY=.05;q.visible=!1};this.unload=function(){A.removeChild(r)};this.show=function(){d=
!1;this.reset();x._startRun()};this._startRun=function(){q.visible=!0;r.alpha=0;r.visible=!0;t=[];t.push((new createjs.Tween.get(r)).to({alpha:1},1200).wait(y-1200-200).to({alpha:.2},200));v=(new createjs.Tween.get(r)).to({x:e},y,createjs.Ease.getPowIn(7));t.push(v);t.push((new createjs.Tween.get(r)).to({y:GATE_FINAL_Y},y,createjs.Ease.getPowIn(7)));t.push((new createjs.Tween.get(r)).to({scaleX:2.3,scaleY:2.3},y,createjs.Ease.getPowIn(6)).call(function(){x.hide()}));this.setSpeed(f);d=!0};this.hide=
function(){d=!1;r.visible=!1;G=!0;h[ON_ELEMENT_HIDE]&&h[ON_ELEMENT_HIDE].call(u[ON_ELEMENT_HIDE])};this.stopUpdate=function(){createjs.Tween.removeTweens(r);d=!1};this.playAnim=function(z){q.gotoAndPlay("anim_"+z);playSfxSound("hit_gate",1,!1)};this.getContainer=function(){return r};this.canBeRemoved=function(){return G};this.setSpeed=function(z){for(var E=0;E<t.length;E++)t[E].timeScale=z};this.update=function(){if(d&&v.position>.86*TIME_GATE_RUN&&(d=!1,h[ON_ELEMENT_CHECK_COLLISION])){var z=new createjs.Rectangle(r.x-
g*r.scaleX/2,r.y-w*r.scaleY,g*r.scaleX,w*r.scaleY);h[ON_ELEMENT_CHECK_COLLISION].call(u[ON_ELEMENT_CHECK_COLLISION],z,this)}};var A=k;this._init(a,b,c)}
function CEndPanel(){var a,b,c,e,k,p,n,m,d,g,w,h,u,v=this;this._init=function(){c=[];e=[];h=new createjs.Container;h.visible=!1;s_oStage.addChild(h);p=new createjs.Shape;p.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);p.alpha=0;k=p.on("click",function(){});h.addChild(p);u=new createjs.Container;u.x=CANVAS_WIDTH/2;h.addChild(u);var q=s_oSpriteLibrary.getSprite("msg_box_wide"),x=createBitmap(q);u.addChild(x);n=new CTLText(u,q.width/2-350,140,700,90,80,"center","#fff",FONT_GAME,
1,0,0," ",!0,!0,!1,!1);m=new CTLText(u,q.width/2-350,270,700,60,50,"center","#fff",FONT_GAME,1,0,0," ",!0,!0,!1,!1);d=new CTLText(u,q.width/2-350,370,700,60,50,"center","#fff",FONT_GAME,1,0,0," ",!0,!0,!1,!1);g=new CGfxButton(q.width/2-200,q.height-185,s_oSpriteLibrary.getSprite("but_home"),u);g.addEventListener(ON_MOUSE_UP,this._onHome,this);w=new CGfxButton(q.width/2+200,q.height-185,s_oSpriteLibrary.getSprite("but_restart"),u);w.addEventListener(ON_MOUSE_UP,this._onRestart,this);a=-q.height/2;
u.regX=q.width/2;u.regY=q.height/2};this.unload=function(){g.unload();w.unload();p.off("click",k)};this.addEventListener=function(q,x,r){c[q]=x;e[q]=r};this.show=function(q,x){setMusicVolume("soundtrack",0);playMusicSound("game_over",1,!1);n.refreshText(x);m.refreshText(TEXT_SCORE+": "+q);d.refreshText(TEXT_BEST_SCORE+": "+s_oMain.getBestScore());p.alpha=0;u.y=a;h.visible=!0;createjs.Tween.get(p).to({alpha:.7},500);createjs.Tween.get(u).wait(400).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.quartOut).call(function(){v.enableButtons()})};
this.hide=function(){createjs.Tween.get(u).to({y:a},500,createjs.Ease.quartOut).call(function(){h.visible=!1;c[b]&&c[b].call(e[b])})};this.enableButtons=function(){g.enable();w.enable()};this.disableButtons=function(){g.disable();w.disable()};this._onHome=function(){v.disableButtons();b=ON_BACK_MENU;v.hide()};this._onRestart=function(){v.disableButtons();$(s_oMain).trigger("show_interlevel_ad");b=ON_RESTART;v.hide()};this._init()}var MS_ROLLING_SCORE=400;
function CRollingScore(){var a=null,b=null;this.rolling=function(c,e,k){a=createjs.Tween.get(c).to({text:k},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(a);c.color="#fff"}).addEventListener("change",function(){c.text=Math.floor(c.text)});null!==e&&(b=createjs.Tween.get(e).to({text:k},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(b)}).addEventListener("change",function(){e.text=Math.floor(e.text)}))};return this}
function CCountdownController(a,b,c){var e,k,p,n,m,d=this;this._init=function(g,w){p=[];n=[];m=new createjs.Container;m.x=g;m.y=w;c.addChild(m);k=[];for(var h=0;4>h;h++){var u=s_oSpriteLibrary.getSprite("countdown_"+(4-h-1)),v=createBitmap(u);v.regX=u.width/2;v.regY=u.height/2;m.addChild(v);k.push(v)}};this.unload=function(){for(var g=0;g<k.length;g++)createjs.Tween.removeTweens(k[g])};this.addEventListener=function(g,w,h){p[g]=w;n[g]=h};this.reset=function(){for(var g=0;g<k.length;g++)k[g].scaleX=
k[g].scaleY=.1,k[g].alpha=0};this.start=function(){e=0;this._playAnim()};this._playAnim=function(){0<e&&createjs.Tween.get(k[e-1]).to({alpha:0},300,createjs.Ease.cubicOut);e===k.length?p[ON_END_COUNTDOWN]&&p[ON_END_COUNTDOWN].call(n[ON_END_COUNTDOWN]):(createjs.Tween.get(k[e]).to({alpha:1},300,createjs.Ease.cubicOut).call(function(){e===k.length-1?playSfxSound("go",1,!1):playSfxSound("countdown",1,!1)}),createjs.Tween.get(k[e]).to({scaleX:1,scaleY:1},1E3,createjs.Ease.quartOut).call(function(){e++;
d._playAnim()}))};this._init(a,b)}
function CSponsor(a,b,c,e){var k,p,n,m,d,g,w=this,h,u,v;this._init=function(q,x){k=!1;p=q;n=x;h=TIME_GATE_RUN;v=1;g=new createjs.Container;g.visible=!1;g.x=q;g.y=x;g.scaleX=g.scaleY=.1;e.addChild(g);var r=s_oSpriteLibrary.getSprite("sponsor_"+(c?0:1)),y=createBitmap(r);y.regX=r.width/2;y.regY=r.height/2;g.addChild(y);c?(y.rotation=5,m=-r.width/2):(y.rotation=-5,m=CANVAS_WIDTH+r.width/2);u=[];d=x-40};this.reset=function(){g.visible=!1;this._resetAnim()};this.startAnim=function(){g.visible=!0;g.alpha=
0;u=[];u.push((new createjs.Tween.get(g)).to({alpha:1},1E3));u.push((new createjs.Tween.get(g)).to({x:m,y:d},h,createjs.Ease.quintIn).call(function(){k?g.visible=!1:(w._resetAnim(),w.startAnim())}));u.push((new createjs.Tween.get(g)).to({scaleX:1,scaleY:1},h,createjs.Ease.quartIn));this.setSpeed(v)};this._resetAnim=function(){k=!1;g.x=p;g.y=n;g.scaleX=g.scaleY=.1};this.readyForRemoval=function(){k=!0};this.stopTween=function(){createjs.Tween.removeTweens(g)};this.setSpeed=function(q){v=q;for(q=0;q<
u.length;q++)u[q].timeScale=v};this._init(a,b)}
function CEncouragement(a,b,c,e){var k,p,n;this._init=function(m,d,g){k=new createjs.Container;k.x=d;k.y=g;k.alpha=0;e.addChild(k);p=new createjs.Text(m," 50px "+FONT_GAME,"#01295b");p.textAlign="center";p.outline=3;k.addChild(p);n=new createjs.Text(m," 50px "+FONT_GAME,"#fff");n.textAlign="center";k.addChild(n);var w=this;createjs.Tween.get(k).to({alpha:1},200,createjs.Ease.quadIn).call(function(){w.moveUp()})};this.moveUp=function(){var m=k.y-400,d=this;createjs.Tween.get(k).to({y:m},1500,createjs.Ease.sineIn).call(function(){d.unload()});
createjs.Tween.get(k).wait(800).to({alpha:0},500)};this.unload=function(){e.removeChild(n)};this._init(c,a,b)}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var a=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(a--,this._oText.font=a+"px "+this._szFont,this._oText.lineHeight=Math.round(a*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>a););this._iFontSize=a}},__verticalAlign:function(){if(this._bVerticalAlign){var a=this._oText.getBounds().height;this._oText.y-=
(a-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(a){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(a,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(a)},setVerticalAlign:function(a){this._bVerticalAlign=a},setOutline:function(a){null!==this._oText&&(this._oText.outline=a)},setShadow:function(a,b,c,e){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(a,b,c,e))},setColor:function(a){this._oText.color=a},setAlpha:function(a){this._oText.alpha=a},setVisible:function(a){this._oText.visible=a},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},setX:function(a){this._oText.x=a},getText:function(){return this._oText},
getY:function(){return this._y},getFontSize:function(){return this._iFontSize},refreshText:function(a){""===a&&(a=" ");null===this._oText&&this.__createText(a);this._oText.text=a;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(a,b,c,e,k,p,n,m,d,g,w,h,u,v,q,x,r){this._oContainer=a;this._x=b;this._y=c;this._iWidth=e;this._iHeight=k;this._bMultiline=x;this._iFontSize=p;this._szAlign=n;this._szColor=m;this._szFont=d;this._iPaddingH=w;this._iPaddingV=h;this._bVerticalAlign=q;this._bFitText=v;this._bDebug=r;this._oDebugShape=null;this._fLineHeightFactor=g;this._oText=null;u&&this.__createText(u)}
function CPowerUp(a,b,c,e,k,p){var n,m,d=!1,g,w,h,u,v,q,x=this,r;x=this;var y,f,t,G;this._init=function(z,E,B){h=[];u=[];n=E;m=B;y=TIME_GATE_RUN;f=p||1;r=new createjs.Container;r.x=E;r.y=B;r.scaleX=r.scaleY=.05;A.addChild(r);w=g=200;new createjs.Rectangle(-g/2,-w,g,w);E=[];for(B=0;50>=B;B++)E.push(s_oSpriteLibrary.getSprite(z==ELEMENT_BOOSTER?"booster_"+B:"star_"+B));z=new createjs.SpriteSheet({images:E,frames:{width:E[0].width,height:E[0].height,regX:E[0].width/2,regY:E[0].height/2},animations:{start:0,
anim:[0,50,"anim"]}});q=createSprite(z,"start",E[0].width/2,E[0].height/2,E[0].width,E[0].height);r.addChild(q);createjs.Tween.get(q,{loop:!0}).to({y:-180},1E3,createjs.Ease.sineInOut).to({y:0},1E3,createjs.Ease.sineInOut);this.show()};this.addEventListener=function(z,E,B){h[z]=E;u[z]=B};this.reset=function(){r.x=n;r.y=m;r.scaleX=r.scaleY=.05;q.visible=!1};this.unload=function(){A.removeChild(r)};this.show=function(){d=!1;q.gotoAndPlay("anim");this.reset();x._startRun()};this._startRun=function(){q.visible=
!0;r.alpha=0;r.visible=!0;t=[];t.push((new createjs.Tween.get(r)).to({alpha:1},1200));v=(new createjs.Tween.get(r)).to({x:e},y,createjs.Ease.getPowIn(7));t.push(v);t.push((new createjs.Tween.get(r)).to({y:GATE_FINAL_Y},y,createjs.Ease.getPowIn(7)));t.push((new createjs.Tween.get(r)).to({scaleX:1.4,scaleY:1.4},y,createjs.Ease.getPowIn(6)).call(function(){x.hide()}));this.setSpeed(f);d=!0};this.hide=function(){d=!1;r.visible=!1;G=!0;h[ON_ELEMENT_HIDE]&&h[ON_ELEMENT_HIDE].call(u[ON_ELEMENT_HIDE],"")};
this.stopUpdate=function(){createjs.Tween.removeTweens(r);d=!1};this.getContainer=function(){return r};this.canBeRemoved=function(){return G};this.setVisible=function(z){r.visible=z};this.setSpeed=function(z){for(var E=0;E<t.length;E++)t[E].timeScale=z};this.update=function(){if(d&&v.position>.84*TIME_GATE_RUN&&(d=!1,h[ON_ELEMENT_CHECK_COLLISION])){var z=new createjs.Rectangle(r.x-g/2,r.y-w,g,w);h[ON_ELEMENT_CHECK_COLLISION].call(u[ON_ELEMENT_CHECK_COLLISION],z,this)}};var A=k;this._init(a,b,c)}
var PATTERN=[];PATTERN[MODE_EASY]=[];PATTERN[MODE_MEDIUM]=[];PATTERN[MODE_HARD]=[];
PATTERN[MODE_EASY][0]=[{final_x:CANVAS_WIDTH/2+700,time_next:700,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-700,time_next:700,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+700,time_next:700,element_type:ELEMENT_ENEMY},
{final_x:CANVAS_WIDTH/2-700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-700,time_next:700,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+700,time_next:700,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/
2-700,time_next:700,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-700,time_next:700,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+700,time_next:1500,element_type:ELEMENT_COIN}];
PATTERN[MODE_EASY][1]=[{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+250,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-250,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},
{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+250,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-250,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/
2+250,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-250,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+250,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,
element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-250,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+250,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2-250,time_next:1500,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_EASY][2]=[{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+250,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-250,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+250,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-250,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/
2+250,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-250,time_next:2E3,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+250,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,
element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-250,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+250,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},
{final_x:CANVAS_WIDTH/2-250,time_next:1500,element_type:ELEMENT_COIN}];
PATTERN[MODE_EASY][3]=[{final_x:CANVAS_WIDTH/2-150,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-550,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-950,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1350,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-600,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:600,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2-1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1350,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-600,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-950,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-550,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-150,time_next:2E3,element_type:ELEMENT_COIN}];
PATTERN[MODE_EASY][4]=[{final_x:CANVAS_WIDTH/2+150,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+550,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+950,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1350,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+600,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:600,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2+1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1350,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+600,time_next:600,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+950,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+550,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+150,time_next:2E3,element_type:ELEMENT_COIN}];
PATTERN[MODE_EASY][5]=[{final_x:CANVAS_WIDTH/2-1350,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-950,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-550,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-150,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+350,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+750,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1150,time_next:600,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+400,time_next:1300,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:800,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1300,time_next:1600,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_EASY][6]=[{final_x:CANVAS_WIDTH/2+1350,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+950,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+550,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+150,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-350,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-750,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1150,time_next:600,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-400,time_next:1300,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:800,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1300,time_next:1600,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_EASY][7]=[{final_x:CANVAS_WIDTH/2+1400,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+800,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:800,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2+300,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+300,time_next:1800,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_EASY][8]=[{final_x:CANVAS_WIDTH/2-1400,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-800,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-300,time_next:800,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2-300,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-300,time_next:1800,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_MEDIUM][0]=[{final_x:CANVAS_WIDTH/2-1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-300,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+200,time_next:600,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2+200,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:1600,element_type:ELEMENT_COIN}];
PATTERN[MODE_MEDIUM][1]=[{final_x:CANVAS_WIDTH/2+1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-200,time_next:600,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2-200,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:1600,element_type:ELEMENT_COIN}];
PATTERN[MODE_MEDIUM][2]=[{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_ENEMY},
{final_x:CANVAS_WIDTH/2-300,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2,time_next:1E3,element_type:ELEMENT_COIN}];
PATTERN[MODE_MEDIUM][3]=[{final_x:CANVAS_WIDTH/2+900,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:1300,element_type:ELEMENT_COIN}];
PATTERN[MODE_MEDIUM][4]=[{final_x:CANVAS_WIDTH/2-900,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:1300,element_type:ELEMENT_COIN}];
PATTERN[MODE_MEDIUM][5]=[{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-200,time_next:1E3,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+200,time_next:1E3,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-600,time_next:0,element_type:ELEMENT_ENEMY},
{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+600,time_next:1400,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_MEDIUM][6]=[{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+200,time_next:1E3,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-200,time_next:1E3,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+600,time_next:0,element_type:ELEMENT_ENEMY},
{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-600,time_next:1400,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_MEDIUM][7]=[{final_x:CANVAS_WIDTH/2,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-500,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+500,time_next:500,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1E3,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1E3,time_next:500,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/
2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:500,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-500,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+500,time_next:1500,element_type:ELEMENT_COIN}];
PATTERN[MODE_HARD][0]=[{final_x:CANVAS_WIDTH/2-1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-300,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+200,time_next:600,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2+200,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+800,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+200,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:1500,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_HARD][1]=[{final_x:CANVAS_WIDTH/2+1400,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-200,time_next:600,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2-200,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:600,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-800,time_next:800,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-200,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:1500,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_HARD][2]=[{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/
2-300,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:1500,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_HARD][3]=[{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+900,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:1E3,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1E3,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2-600,time_next:500,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-600,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:1400,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_HARD][4]=[{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-900,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+300,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:1E3,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1E3,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_COIN},
{final_x:CANVAS_WIDTH/2+600,time_next:500,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+600,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:1400,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_HARD][5]=[{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-200,time_next:1E3,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-400,time_next:0,element_type:ELEMENT_ENEMY},
{final_x:CANVAS_WIDTH/2+200,time_next:1E3,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-600,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1E3,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1E3,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+600,time_next:1400,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_HARD][6]=[{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+200,time_next:1E3,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+400,time_next:0,element_type:ELEMENT_ENEMY},
{final_x:CANVAS_WIDTH/2-200,time_next:1E3,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+600,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1E3,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1E3,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-600,time_next:1400,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_HARD][7]=[{final_x:CANVAS_WIDTH/2+1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+200,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:1300,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_HARD][8]=[{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-200,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+400,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+1400,time_next:1300,element_type:ELEMENT_ENEMY}];
PATTERN[MODE_HARD][9]=[{final_x:CANVAS_WIDTH/2,time_next:500,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-500,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+500,time_next:500,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1E3,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1E3,time_next:500,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/
2,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2-1400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+1400,time_next:500,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2+400,time_next:0,element_type:ELEMENT_ENEMY},{final_x:CANVAS_WIDTH/2-800,time_next:0,element_type:ELEMENT_COIN},{final_x:CANVAS_WIDTH/2+800,time_next:1500,element_type:ELEMENT_COIN}];
function CCoin(a,b,c,e,k,p,n){var m,d,g=!1,w,h,u,v,q,x,r,y,f,t,G=this,A,z,E,B;this._init=function(L,M,Q){u=[];v=[];m=M;d=Q;A=TIME_GATE_RUN;z=n||1;t=new createjs.Container;t.x=M;t.y=Q;t.scaleX=t.scaleY=.05;P.addChild(t);h=w=200;new createjs.Rectangle(-w/2,-h,w,h);y=b;y.visible=!1;t.addChild(y);x=L;r=0==Math.floor(2*Math.random())?"0":"1";t.addChild(x);createjs.Tween.get(x,{loop:!0}).to({y:-180},1E3,createjs.Ease.sineInOut).to({y:0},1E3,createjs.Ease.sineInOut);this.show()};this.addEventListener=function(L,
M,Q){u[L]=M;v[L]=Q};this.reset=function(){t.x=m;t.y=d;t.scaleX=t.scaleY=.05;x.visible=!1};this.unload=function(){P.removeChild(t);y.off("animationend",f)};this.show=function(){g=!1;x.gotoAndPlay("anim_"+r);this.reset();G._startRun()};this.collect=function(){createjs.Tween.removeTweens(t);createjs.Tween.removeTweens(x);E=[];var L=t.y-400;E.push((new createjs.Tween.get(t)).to({y:L},1E3,createjs.Ease.quintOut));E.push((new createjs.Tween.get(x)).wait(500).to({alpha:.1},500,createjs.Ease.quintOut).call(function(){x.visible=
!1}));y.visible=!0;y.gotoAndPlay("anim");f=y.on("animationend",G.hide);playSfxSound("collect_present",1,!1)};this._startRun=function(){x.visible=!0;t.alpha=0;t.visible=!0;E=[];E.push((new createjs.Tween.get(t)).to({alpha:1},1200));q=(new createjs.Tween.get(t)).to({x:k},A,createjs.Ease.getPowIn(7));E.push(q);E.push((new createjs.Tween.get(t)).to({y:GATE_FINAL_Y},A,createjs.Ease.getPowIn(7)));E.push((new createjs.Tween.get(t)).to({scaleX:1.4,scaleY:1.4},A,createjs.Ease.getPowIn(6)).call(function(){G.hide()}));
this.setSpeed(z);g=!0};this.hide=function(){g=!1;t.visible=!1;B=!0;u[ON_ELEMENT_HIDE]&&u[ON_ELEMENT_HIDE].call(v[ON_ELEMENT_HIDE],"")};this.stopUpdate=function(){createjs.Tween.removeTweens(t);g=!1};this.getContainer=function(){return t};this.canBeRemoved=function(){return B};this.setVisible=function(L){t.visible=L};this.setSpeed=function(L){for(var M=0;M<E.length;M++)E[M].timeScale=L};this.update=function(){if(g&&q.position>.84*TIME_GATE_RUN&&(g=!1,u[ON_ELEMENT_CHECK_COLLISION])){var L=new createjs.Rectangle(t.x-
w/2,t.y-h,w,h);u[ON_ELEMENT_CHECK_COLLISION].call(v[ON_ELEMENT_CHECK_COLLISION],L,this)}};var P=p;this._init(a,c,e)};